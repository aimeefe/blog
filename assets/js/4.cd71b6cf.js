(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{176:function(t,s,a){t.exports=a.p+"assets/img/js-map.66b368d1.png"},177:function(t,s,a){t.exports=a.p+"assets/img/js-es6+.7b28f321.png"},178:function(t,s,a){t.exports=a.p+"assets/img/js-split__chunks__asyncmap.2b5ed960.png"},179:function(t,s,a){t.exports=a.p+"assets/img/js-split__chunks__default.daf04f01.png"},180:function(t,s,a){t.exports=a.p+"assets/img/js-split__chunks__initialmap.18943a14.png"},181:function(t,s,a){t.exports=a.p+"assets/img/js-split__chunks__initial.db009ab0.png"},182:function(t,s,a){t.exports=a.p+"assets/img/js-split__chunks__all.1f1da2ed.png"},253:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"打包js"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#打包js"}},[t._v("#")]),t._v(" 打包JS")]),t._v(" "),n("p",[n("code",[t._v("webpack")]),t._v("中关于"),n("code",[t._v("js")]),t._v("的处理，大致包含以下这些：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(176),alt:"webpack 中的js处理"}})]),t._v(" "),n("h2",{attrs:{id:"使用-babel-转换-es6-语法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#使用-babel-转换-es6-语法"}},[t._v("#")]),t._v(" 使用 babel 转换 ES6+ 语法")]),t._v(" "),n("p",[t._v("在使用"),n("code",[t._v("babel")]),t._v("转换"),n("code",[t._v("ES6+")]),t._v("代码之前，先来了解下关于"),n("code",[t._v("babel")]),t._v("的几个基础知识："),n("a",{attrs:{href:"https://www.jianshu.com/p/0e6673a81fbd",target:"_blank",rel:"noopener noreferrer"}},[t._v("关于babel"),n("OutboundLink")],1)]),t._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),n("hr"),t._v(" "),n("p",[t._v("🍃"),n("strong",[t._v("babel 是什么")])]),t._v(" "),n("p",[t._v("babel 是一个编译器，它可以将"),n("code",[t._v("ES2015+")]),t._v("代码转换成"),n("code",[t._v("ES2015")]),t._v("代码，以便能够运行在当前和旧版本浏览器或其他环境中，它的工作流程大致分为以下几步：")]),t._v(" "),n("ol",[n("li",[n("p",[t._v("解析：通过词法分析、语法分析，将"),n("code",[t._v("javascript")]),t._v("源代码转换称为"),n("code",[t._v("AST")]),t._v("抽象语法树")])]),t._v(" "),n("li",[n("p",[t._v("转换：将"),n("code",[t._v("AST")]),t._v("进行转换操作，再把"),n("code",[t._v("ES2015+")]),t._v("的部分转换为"),n("code",[t._v("ES5")])])]),t._v(" "),n("li",[n("p",[t._v("输出：将转换后的语法树重新生成代码，然后进行输出")])])]),t._v(" "),n("hr"),t._v(" "),n("p",[t._v("🍃"),n("strong",[t._v("插件")])]),t._v(" "),n("p",[n("code",[t._v("babel")]),t._v("什么动作都不做，如果不使用插件的话就会将代码解析之后再输出同样的代码，类似于"),n("code",[t._v("const babel = code => code")]),t._v("。因此，如果我们想让"),n("code",[t._v("babel")]),t._v("按照我们的预期来完成代码转化，那么久需要在转换阶段通过配置的一系列转换插件来帮助我们完成，如：")]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"plugins"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@babel/plugin-transform-arrow-functions"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@babel/plugin-transform-block-scoped-functions"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//...")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("hr"),t._v(" "),n("p",[t._v("🍃"),n("strong",[t._v("预设 preset")])]),t._v(" "),n("p",[t._v("如果通过手动配置很多的"),n("code",[t._v("plugin")]),t._v("，维护起来是很困难的，因此我们可以通过预设"),n("code",[t._v("preset")]),t._v("来帮助我们解决这个问题，"),n("code",[t._v("preset")]),t._v("是一堆"),n("code",[t._v("plugin")]),t._v("的简写，如：")]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  presets"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@babel/preset-env'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("如上，这样写的话就可以默认包含了所有转换"),n("code",[t._v("ES5+")]),t._v("标准语法的"),n("code",[t._v("plugin")]),t._v("，而不需要我们再去手动一个个的去设置相关"),n("code",[t._v("plugin")])])]),t._v(" "),n("h2",{attrs:{id:"开始"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#开始"}},[t._v("#")]),t._v(" 开始")]),t._v(" "),n("p",[t._v("在开始之前，我们先来创建以下目录：")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("├─package.json\n├─src                 // 存放入口文件和开发文件\n│  └─index.js  \n├─webpack.config.js   // webpack 配置文件\n")])])]),n("p",[t._v("接下来打开入口文件，写点"),n("code",[t._v("es6")]),t._v("的东西，如下：")]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// src/index.js")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" items "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("of")]),t._v(" items"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("现在开始使用"),n("code",[t._v("babel")]),t._v("来编译"),n("code",[t._v("es6+")]),t._v("代码，具体如下：")]),t._v(" "),n("ol",[n("li",[t._v("安装")])]),t._v(" "),n("p",[n("code",[t._v("cnpm install babel-loader @babel/core @babel/preset-env -D")])]),t._v(" "),n("ul",[n("li",[t._v("babel/core：")]),t._v(" "),n("li",[t._v("babel/preset-env")])]),t._v(" "),n("ol",{attrs:{start:"2"}},[n("li",[t._v("编辑"),n("code",[t._v("webpack.config.js")]),t._v("，配置如下：")])]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" resolve "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'path'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nmodule"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//...")]),t._v("\n  module"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    rules"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      test"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token regex"}},[t._v("/\\.js$/")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      use"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        loader"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'babel-loader'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        options"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 预设")]),t._v("\n          presets"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@babel/preset-env'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("终端执行"),n("code",[t._v("npx webpack")]),t._v("，进行打包。成功后，打开编译后目录下的"),n("code",[t._v("index.js")]),t._v("查看，会发现"),n("code",[t._v("es6+")]),t._v("代码已经被编译成了"),n("code",[t._v("es5")]),t._v("的代码，如下：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(177),alt:"webpack编译es6+"}})]),t._v(" "),n("h3",{attrs:{id:"补充缺失语法（垫片）"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#补充缺失语法（垫片）"}},[t._v("#")]),t._v(" 补充缺失语法（垫片）")]),t._v(" "),n("p",[n("code",[t._v("Babel")]),t._v("只转换"),n("code",[t._v("syntax")]),t._v("层语法，所以需要"),n("code",[t._v("@babel/polyfill")]),t._v("来处理"),n("code",[t._v("API")]),t._v("兼容，又因为"),n("code",[t._v("polyfill")]),t._v("体积太大，所以通过"),n("code",[t._v("preset")]),t._v("的"),n("code",[t._v("useBuiltIns")]),t._v("来实现按需加载，再接着为了满足"),n("code",[t._v("npm")]),t._v("组件开发的需要出现了"),n("code",[t._v("@babel/runtime")]),t._v("来做隔离。"),n("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/58624930",target:"_blank",rel:"noopener noreferrer"}},[t._v("Babel学习系列4-polyfill和runtime差别(必看)"),n("OutboundLink")],1)]),t._v(" "),n("p",[t._v("接下来我们来分别看看"),n("code",[t._v("babel-polyfill")]),t._v("和"),n("code",[t._v("babel-runtime")]),t._v("的使用方法")]),t._v(" "),n("h4",{attrs:{id:"babel-polyfill"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#babel-polyfill"}},[t._v("#")]),t._v(" babel-polyfill")]),t._v(" "),n("ol",[n("li",[n("p",[t._v("安装："),n("code",[t._v("cnpm install @babel/polyfill -S")])])]),t._v(" "),n("li",[n("p",[t._v("在需要的js文件顶部引入"),n("code",[t._v("polyfill")]),t._v(" 即可，如下：")])])]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// src/index.js")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@babel/polyfill"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" items "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("of")]),t._v(" items"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" mergeArr "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Object"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("assign")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" items"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mergeArr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),n("p",[t._v("再次打包，就会发现之前没有被转译掉的"),n("code",[t._v("Object.assign")]),t._v("会正确在浏览器中运行")]),t._v(" "),n("p",[t._v("接下来是对"),n("code",[t._v("@babel/polyfill")]),t._v("实现按需加载，如下")]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[t._v("\nmodule"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n  module"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    rules"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        test"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token regex"}},[t._v("/\\.js$/")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 不包含")]),t._v("\n          exclude"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token regex"}},[t._v("/node_modules/")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          loader"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'babel-loader'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// options 里面的配置也可以放到根目录下的.babelrc 文件中")]),t._v("\n          options"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            presets"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@babel/preset-env'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" useBuiltIns"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'usage'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n          "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" \n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("  \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h4",{attrs:{id:"babel-runtime"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#babel-runtime"}},[t._v("#")]),t._v(" babel-runtime")]),t._v(" "),n("p",[t._v("TODODODODOODO")]),t._v(" "),n("h2",{attrs:{id:"代码分割（优化）"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#代码分割（优化）"}},[t._v("#")]),t._v(" 代码分割（优化）")]),t._v(" "),n("p",[t._v("代码分割允许我们把一个大文件拆分成多个小文件，然后去按需/并行加载这些文件，如果使用合理会大大减少页面的加载时间，常用的代码分割的方式有以下三种：")]),t._v(" "),n("ul",[n("li",[t._v("入口起点：通过"),n("code",[t._v("entry")]),t._v("手动配置多个入口文件")]),t._v(" "),n("li",[t._v("避免重复：通过"),n("code",[t._v("splitChunks")]),t._v("插件删除并提取公共代码作为一个单独"),n("code",[t._v("chunks")])]),t._v(" "),n("li",[t._v("动态导入：调用"),n("code",[t._v("import()")]),t._v("或"),n("code",[t._v("require.ensure()")]),t._v("异步加载模块")])]),t._v(" "),n("p",[t._v("下面我们会分别对这三种拆包方式进行试验")]),t._v(" "),n("h3",{attrs:{id:"第一种：entry-多入口拆包"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第一种：entry-多入口拆包"}},[t._v("#")]),t._v(" 第一种：entry 多入口拆包")]),t._v(" "),n("p",[t._v("使用"),n("code",[t._v("entry")]),t._v("多入口进行拆包，类似这样：")]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\nmodule"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// entry: './src/index.js',")]),t._v("\n  entry"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    file1"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./src/file1.js'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    file2"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./src/file2.js'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n    index"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./src/index.js'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  output"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// filename: 'index.js',")]),t._v("\n    filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'[name].js'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    path"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dist'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    libraryTarget"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'umd'")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),n("p",[t._v("这种方式是由弊端的：")]),t._v(" "),n("p",[n("code",[t._v("entry")]),t._v("中配置的所有文件，分别引入了同一个模块时会出现重复打包该模块的情况，而不会把这个共用的模块进行抽离")]),t._v(" "),n("p",[t._v("因此，这种分包方式并没有被广泛使用，接下来可以看看"),n("code",[t._v("splitChunks")]),t._v("是如何来解决这种重复打包的情况的")]),t._v(" "),n("h3",{attrs:{id:"splitchunks"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#splitchunks"}},[t._v("#")]),t._v(" splitChunks")]),t._v(" "),n("p",[t._v("以前，我们使用"),n("code",[t._v("CommonsChunkPlugin")]),t._v("分包来避免依赖重复，但在"),n("code",[t._v("4.0")]),t._v("版本开始它已被移除。现在我们通过"),n("code",[t._v("optimization.splitChunks")]),t._v("和"),n("code",[t._v("optimization.runtimeChunks")]),t._v("来代替它")]),t._v(" "),n("h4",{attrs:{id:"开始之前"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#开始之前"}},[t._v("#")]),t._v(" 开始之前")]),t._v(" "),n("p",[t._v("在开始之前，先了解三个名词："),n("a",{attrs:{href:"https://www.cnblogs.com/kwzm/p/10314438.html",target:"_blank",rel:"noopener noreferrer"}},[n("OutboundLink")],1)]),t._v(" "),n("ul",[n("li",[n("p",[t._v("module："),n("code",[t._v("js")]),t._v("模块化"),n("code",[t._v("webpack")]),t._v("支持"),n("code",[t._v("commonjs、es6")]),t._v("等模块化规范，简单来说就是通过"),n("code",[t._v("import")]),t._v("等语句引入的代码")])]),t._v(" "),n("li",[n("p",[t._v("chunk："),n("code",[t._v("chunk")]),t._v("是"),n("code",[t._v("webpack")]),t._v("根据功能拆分出来的情况。它包含三种：")]),t._v(" "),n("ol",[n("li",[t._v("项目入口"),n("code",[t._v("entry")])]),t._v(" "),n("li",[t._v("通过"),n("code",[t._v("import()")]),t._v("动态导入的代码")]),t._v(" "),n("li",[t._v("通过"),n("code",[t._v("splitChunks")]),t._v("拆分出来的代码")])]),t._v(" "),n("p",[n("code",[t._v("splitChunks")]),t._v("就是在"),n("code",[t._v("chunk")]),t._v("的基础上进行拆分的。"),n("code",[t._v("chunk")]),t._v("包含"),n("code",[t._v("module")]),t._v("，可能是一对一或者一对多")])]),t._v(" "),n("li",[n("p",[t._v("bundle："),n("code",[t._v("bundle")]),t._v("是"),n("code",[t._v("webpack")]),t._v("打包之后生成的文件，一般是和"),n("code",[t._v("chunk")]),t._v("一对一的关系")])])]),t._v(" "),n("h4",{attrs:{id:"目录准备"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#目录准备"}},[t._v("#")]),t._v(" 目录准备")]),t._v(" "),n("p",[t._v("在了解"),n("code",[t._v("optimization.splitChunks")]),t._v("之前，先准备以下目录：")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("├─package.json\n├─src                 \n│  └─file1.js         // 同步引入 jquery, vue, file4\n│  └─file2.js         // 同步引入 lodash, file4, file5\n│  └─file3.js         // 同步引入 file5\n│  └─file4.js         // 共用模块，被 file1 和 file2 使用\n│  └─file5.js         // 共用模块，被 file2 和 file3 使用\n│  └─index.js         // 主入口：异步引入 file1, file2；同步引入 file3, vue\n├─webpack.config.js   // webpack 配置文件\n")])])]),n("p",[t._v("现有 3 个"),n("code",[t._v("chunk")]),t._v("，分别是通过"),n("code",[t._v("import")]),t._v("动态导入的"),n("code",[t._v("file1")]),t._v("、"),n("code",[t._v("file2")]),t._v("和入口文件"),n("code",[t._v("index")]),t._v("，其中：")]),t._v(" "),n("ul",[n("li",[t._v("file1 和 file2 共用"),n("code",[t._v("file4")])]),t._v(" "),n("li",[t._v("file2 和 file3 共用"),n("code",[t._v("file5")])])]),t._v(" "),n("p",[t._v("文件内容如下：")]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// index.js")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./file3'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" vue "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vue'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v('/* webpackChunkName: "file1" */')]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./file1'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v('/* webpackChunkName: "file2" */')]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./file2'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// file1.js")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" $ "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'jquery'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" vue "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vue'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" name "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./file4'")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// file2.js")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" _ "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'lodash'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" age "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./file4'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" a "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./file5'")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// file3.js")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" a "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./file5'")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// file4.js")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" name "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'lily'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" age "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// file5.js")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" a "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("123")]),t._v("\n")])])]),n("h4",{attrs:{id:"开箱即用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#开箱即用"}},[t._v("#")]),t._v(" 开箱即用")]),t._v(" "),n("p",[n("code",[t._v("optimization.splitChunks")]),t._v("是开箱即用的，即对它"),n("code",[t._v("不做任何配置")]),t._v("的时候它就可以进行拆包工作。其默认拆分代码规则如下：")]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[t._v("module"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  optimization"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    splitChunks"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      chunks"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"async"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      minSize"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("30000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      maxSize"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      minChunks"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      maxAsyncRequests"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      maxInitialRequests"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      automaticNameDelimiter"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"~"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      name"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      cacheGroups"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        vendors"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          test"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token regex"}},[t._v("/[\\\\/]node_modules[\\\\/]/")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          priority"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          minChunks"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          priority"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          reuseExistingChunk"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("div",{staticClass:"custom-block warning"},[n("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),n("p",[t._v("不要在没有实践测量的情况下，尝试手动优化这些参数。默认模式是经过千挑万选的，可以用于满足最佳web性能的策略")])]),t._v(" "),n("p",[t._v("说明：")]),t._v(" "),n("p",[t._v("🍃"),n("strong",[t._v("splitChunks.chunks")])]),t._v(" "),n("p",[t._v("它可以设置三个值，分别是"),n("code",[t._v("all、async、initial")]),t._v("。默认值"),n("code",[t._v("async")]),t._v("，因为"),n("code",[t._v("webpack")]),t._v("更希望将代码中异步引入的部分作为独立模块进行抽离，在需要的时候再引入，这样懒加载的形式可以提升页面性能。三个值的具体表现如下：")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("async：默认值，从异步加载（如"),n("code",[t._v("import()")]),t._v("动态引入）的"),n("code",[t._v("chunk")]),t._v("开始进行拆分，遵循以下规律：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(178),alt:"splitChunks.chunks=initial的流程图"}})]),t._v(" "),n("p",[t._v("下面来看看"),n("code",[t._v("chunks.async")]),t._v("的具体表现：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(179),alt:"slitChunks默认分割"}})]),t._v(" "),n("p",[t._v("如图：file1、file2、index 这三个 chunk 被拆分的情况如下：")]),t._v(" "),n("ol",[n("li",[t._v("index：单独抽离到了"),n("code",[t._v("index.js")]),t._v("，包括同步引入的"),n("code",[t._v("vue")]),t._v("、"),n("code",[t._v("file3")]),t._v("及"),n("code",[t._v("file3")]),t._v("中同步引入的"),n("code",[t._v("file5")])]),t._v(" "),n("li",[t._v("file1：单独抽离成"),n("code",[t._v("file1.index.js")]),t._v("；引用的第三方包 jquery 和 vue，都被抽离到了"),n("code",[t._v("vendors~file1.index.js")])]),t._v(" "),n("li",[t._v("file2：单独抽离到了"),n("code",[t._v("file2.index.js")]),t._v("；引用的第三方包 lodash，抽离到了"),n("code",[t._v("vendors~file2.index.js")])])])])]),t._v(" "),n("hr"),t._v(" "),n("ul",[n("li",[n("p",[t._v("initial：从入口处"),n("code",[t._v("chunk")]),t._v("开始进行拆分，遵循以下规律：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(180),alt:"splitChunks.chunks=initial的流程图"}})]),t._v(" "),n("p",[t._v("下面来看看"),n("code",[t._v("chunks.initial")]),t._v("的具体表现：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(181),alt:"splitChunks.chunks=initial"}})]),t._v(" "),n("p",[t._v("如图：file1、file2、index 这三个 chunk 被拆分的情况如下：")]),t._v(" "),n("ol",[n("li",[t._v("file1：被拆分成"),n("code",[t._v("file1.index.js")]),t._v("，不对"),n("code",[t._v("file1")]),t._v("内容再次进行拆分")]),t._v(" "),n("li",[t._v("file2：被拆分成"),n("code",[t._v("file2.index.js")]),t._v("，不对"),n("code",[t._v("file2")]),t._v("内容再次进行拆分")]),t._v(" "),n("li",[t._v("index：被拆分成"),n("code",[t._v("index.js")]),t._v("，其中引入的第三方模块被拆分到 "),n("code",[t._v("vendors~main.index.js")])])])])]),t._v(" "),n("hr"),t._v(" "),n("ul",[n("li",[n("p",[t._v("all：以上两者都包括，同步、异步模块均进行拆分")]),t._v(" "),n("p",[n("img",{attrs:{src:a(182),alt:"splitChunks.chunks=all"}})])])]),t._v(" "),n("hr"),t._v(" "),n("p",[t._v("🍃"),n("strong",[t._v("minSize")]),t._v("：")]),t._v(" "),n("p",[t._v("当模块大于"),n("code",[t._v("minSize")]),t._v("时，进行代码分割")]),t._v(" "),n("hr"),t._v(" "),n("p",[t._v("🍃"),n("strong",[t._v("minChunks")]),t._v("：")]),t._v(" "),n("p",[t._v("该模块最少被使用了"),n("code",[t._v("minChunks")]),t._v("时才被分割出来")]),t._v(" "),n("hr"),t._v(" "),n("p",[t._v("🍃"),n("strong",[t._v("reuseExistingChunk")]),t._v("：")]),t._v(" "),n("p",[t._v("重复使用已经存在的块，若某个模块在之前已经被打包过了，后面打包时再遇到这个模块就直接使用之前打包的模块")]),t._v(" "),n("hr"),t._v(" "),n("p",[t._v("🍃"),n("strong",[t._v("name")]),t._v("：")]),t._v(" "),n("p",[t._v("是否以"),n("code",[t._v("cacheGroups")]),t._v("中的"),n("code",[t._v("filename")]),t._v("作为文件名")]),t._v(" "),n("hr"),t._v(" "),n("p",[t._v("🍃"),n("strong",[t._v("automaticNameDelimiter")]),t._v("：")]),t._v(" "),n("p",[t._v("打包的"),n("code",[t._v("chunk")]),t._v("名字连接符，如设为"),n("code",[t._v("~")]),t._v(",生成的"),n("code",[t._v("chunk")]),t._v("文件名为"),n("code",[t._v("chunk~name.js")])]),t._v(" "),n("hr"),t._v(" "),n("h4",{attrs:{id:"分包策略"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#分包策略"}},[t._v("#")]),t._v(" 分包策略")]),t._v(" "),n("p",[t._v("在知道以上这些规则后，我们设置一个自己的"),n("a",{attrs:{href:"https://www.jianshu.com/p/4f0600ea1c5f",target:"_blank",rel:"noopener noreferrer"}},[t._v("分包策略"),n("OutboundLink")],1),t._v("，如：")]),t._v(" "),n("ul",[n("li",[t._v("基础类库：react，react-redux，react-router")]),t._v(" "),n("li",[t._v("UI 库：antd，antd-icons")]),t._v(" "),n("li",[t._v("公共组件库：自定义的公共组件")]),t._v(" "),n("li",[t._v("低频组件：echart")]),t._v(" "),n("li",[t._v("业务代码")])]),t._v(" "),n("h3",{attrs:{id:"动态导入-import"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#动态导入-import"}},[t._v("#")]),t._v(" 动态导入 import()")]),t._v(" "),n("p",[t._v("动态导入"),n("code",[t._v("import()")]),t._v("，是一个异步"),n("code",[t._v("chunk")]),t._v("，"),n("code",[t._v("webpack")]),t._v("会对它进行单独打包，")]),t._v(" "),n("p",[n("code",[t._v("import()")]),t._v("接收模块名作为参数并返回"),n("code",[t._v("Promise")]),t._v("："),n("code",[t._v("import(name) -> Promise")])]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 一个简单的例子：")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./file1'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("r")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//...")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),n("h4",{attrs:{id:"魔法注释"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#魔法注释"}},[t._v("#")]),t._v(" 魔法注释")]),t._v(" "),n("p",[t._v("动态导入"),n("code",[t._v("import()")]),t._v("不允许我们在导入的时候使用除了文件名以外的任何参数，因此我们可以使用"),n("code",[t._v("webpack")]),t._v("中的魔法注释来帮我们使用附加参数，常用的几个如下：")]),t._v(" "),n("ol",[n("li",[t._v("webpackChunkName：它可以指定当前异步"),n("code",[t._v("chunk")]),t._v("被打包后的文件名称")])]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*webpackChunkName*/")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./file1'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("r")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//...")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),n("ol",{attrs:{start:"2"}},[n("li",[t._v("webpackPrefetch：预先拉取，在使用之前加载；它会在浏览器空闲的时候才来加载该模块")])]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*webpackPrefetch: true*/")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./file1'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("r")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//...")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),n("ol",{attrs:{start:"3"}},[n("li",[t._v("webpackPreload：")])]),t._v(" "),n("p",[t._v("懒加载，在使用的时候才去下载（因此会有一定的加载时间造成用户等待）；比如点击某个按钮加载弹窗，在点击按钮的时候，浏览器会马上加载这部分需要的文件")]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*webpackPreload: true*/")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./file1'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("r")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//...")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);