
# æ‰“åŒ…JS

`webpack`ä¸­å…³äºŽ`js`çš„å¤„ç†ï¼Œå¤§è‡´åŒ…å«ä»¥ä¸‹è¿™äº›ï¼š

![webpack ä¸­çš„jså¤„ç†](./images/js-map.png)

## ä½¿ç”¨ babel è½¬æ¢ ES6+ è¯­æ³•

åœ¨ä½¿ç”¨`babel`è½¬æ¢`ES6+`ä»£ç ä¹‹å‰ï¼Œå…ˆæ¥äº†è§£ä¸‹å…³äºŽ`babel`çš„å‡ ä¸ªåŸºç¡€çŸ¥è¯†ï¼š[å…³äºŽbabel](https://www.jianshu.com/p/0e6673a81fbd)

:::tip

--------------

ðŸƒ**babel æ˜¯ä»€ä¹ˆ**

babel æ˜¯ä¸€ä¸ªç¼–è¯‘å™¨ï¼Œå®ƒå¯ä»¥å°†`ES2015+`ä»£ç è½¬æ¢æˆ`ES2015`ä»£ç ï¼Œä»¥ä¾¿èƒ½å¤Ÿè¿è¡Œåœ¨å½“å‰å’Œæ—§ç‰ˆæœ¬æµè§ˆå™¨æˆ–å…¶ä»–çŽ¯å¢ƒä¸­ï¼Œå®ƒçš„å·¥ä½œæµç¨‹å¤§è‡´åˆ†ä¸ºä»¥ä¸‹å‡ æ­¥ï¼š

1. è§£æžï¼šé€šè¿‡è¯æ³•åˆ†æžã€è¯­æ³•åˆ†æžï¼Œå°†`javascript`æºä»£ç è½¬æ¢ç§°ä¸º`AST`æŠ½è±¡è¯­æ³•æ ‘

2. è½¬æ¢ï¼šå°†`AST`è¿›è¡Œè½¬æ¢æ“ä½œï¼Œå†æŠŠ`ES2015+`çš„éƒ¨åˆ†è½¬æ¢ä¸º`ES5`

3. è¾“å‡ºï¼šå°†è½¬æ¢åŽçš„è¯­æ³•æ ‘é‡æ–°ç”Ÿæˆä»£ç ï¼Œç„¶åŽè¿›è¡Œè¾“å‡º

--------------

ðŸƒ**æ’ä»¶**

`babel`ä»€ä¹ˆåŠ¨ä½œéƒ½ä¸åšï¼Œå¦‚æžœä¸ä½¿ç”¨æ’ä»¶çš„è¯å°±ä¼šå°†ä»£ç è§£æžä¹‹åŽå†è¾“å‡ºåŒæ ·çš„ä»£ç ï¼Œç±»ä¼¼äºŽ`const babel = code => code`ã€‚å› æ­¤ï¼Œå¦‚æžœæˆ‘ä»¬æƒ³è®©`babel`æŒ‰ç…§æˆ‘ä»¬çš„é¢„æœŸæ¥å®Œæˆä»£ç è½¬åŒ–ï¼Œé‚£ä¹ˆä¹…éœ€è¦åœ¨è½¬æ¢é˜¶æ®µé€šè¿‡é…ç½®çš„ä¸€ç³»åˆ—è½¬æ¢æ’ä»¶æ¥å¸®åŠ©æˆ‘ä»¬å®Œæˆï¼Œå¦‚ï¼š

```javascript
{
  "plugins": [
    "@babel/plugin-transform-arrow-functions", 
    "@babel/plugin-transform-block-scoped-functions",
    //...
   ]
}
```

--------------

ðŸƒ**é¢„è®¾ preset**

å¦‚æžœé€šè¿‡æ‰‹åŠ¨é…ç½®å¾ˆå¤šçš„`plugin`ï¼Œç»´æŠ¤èµ·æ¥æ˜¯å¾ˆå›°éš¾çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡é¢„è®¾`preset`æ¥å¸®åŠ©æˆ‘ä»¬è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œ`preset`æ˜¯ä¸€å †`plugin`çš„ç®€å†™ï¼Œå¦‚ï¼š

```javascript
{
  presets: ['@babel/preset-env']
}
```
å¦‚ä¸Šï¼Œè¿™æ ·å†™çš„è¯å°±å¯ä»¥é»˜è®¤åŒ…å«äº†æ‰€æœ‰è½¬æ¢`ES5+`æ ‡å‡†è¯­æ³•çš„`plugin`ï¼Œè€Œä¸éœ€è¦æˆ‘ä»¬å†åŽ»æ‰‹åŠ¨ä¸€ä¸ªä¸ªçš„åŽ»è®¾ç½®ç›¸å…³`plugin`
:::

## å¼€å§‹

åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥åˆ›å»ºä»¥ä¸‹ç›®å½•ï¼š

```
â”œâ”€package.json
â”œâ”€src                 // å­˜æ”¾å…¥å£æ–‡ä»¶å’Œå¼€å‘æ–‡ä»¶
â”‚  â””â”€index.js  
â”œâ”€webpack.config.js   // webpack é…ç½®æ–‡ä»¶
```
æŽ¥ä¸‹æ¥æ‰“å¼€å…¥å£æ–‡ä»¶ï¼Œå†™ç‚¹`es6`çš„ä¸œè¥¿ï¼Œå¦‚ä¸‹ï¼š

```javascript
// src/index.js
const items = [1, 2, 3, 4, 5, 6]

for (let i of items) {
  console.log(i)
}
```

çŽ°åœ¨å¼€å§‹ä½¿ç”¨`babel`æ¥ç¼–è¯‘`es6+`ä»£ç ï¼Œå…·ä½“å¦‚ä¸‹ï¼š


1. å®‰è£…

`cnpm install babel-loader @babel/core @babel/preset-env -D`

- babel/coreï¼š
- babel/preset-env

2. ç¼–è¾‘`webpack.config.js`ï¼Œé…ç½®å¦‚ä¸‹ï¼š

```javascript
const { resolve } = require('path')

module.exports = {
  //...
  module: {
    rules: [{
      test: /\.js$/,
      use: {
        loader: 'babel-loader',
        options: {
          // é¢„è®¾
          presets: ['@babel/preset-env']
        }
      }
    }]
  }
}
```

ç»ˆç«¯æ‰§è¡Œ`npx webpack`ï¼Œè¿›è¡Œæ‰“åŒ…ã€‚æˆåŠŸåŽï¼Œæ‰“å¼€ç¼–è¯‘åŽç›®å½•ä¸‹çš„`index.js`æŸ¥çœ‹ï¼Œä¼šå‘çŽ°`es6+`ä»£ç å·²ç»è¢«ç¼–è¯‘æˆäº†`es5`çš„ä»£ç ï¼Œå¦‚ä¸‹ï¼š

![webpackç¼–è¯‘es6+](./images/js-es6+.png)


### è¡¥å……ç¼ºå¤±è¯­æ³•ï¼ˆåž«ç‰‡ï¼‰

`Babel`åªè½¬æ¢`syntax`å±‚è¯­æ³•ï¼Œæ‰€ä»¥éœ€è¦`@babel/polyfill`æ¥å¤„ç†`API`å…¼å®¹ï¼Œåˆå› ä¸º`polyfill`ä½“ç§¯å¤ªå¤§ï¼Œæ‰€ä»¥é€šè¿‡`preset`çš„`useBuiltIns`æ¥å®žçŽ°æŒ‰éœ€åŠ è½½ï¼Œå†æŽ¥ç€ä¸ºäº†æ»¡è¶³`npm`ç»„ä»¶å¼€å‘çš„éœ€è¦å‡ºçŽ°äº†`@babel/runtime`æ¥åšéš”ç¦»ã€‚[Babelå­¦ä¹ ç³»åˆ—4-polyfillå’Œruntimeå·®åˆ«(å¿…çœ‹)](https://zhuanlan.zhihu.com/p/58624930)

æŽ¥ä¸‹æ¥æˆ‘ä»¬æ¥åˆ†åˆ«çœ‹çœ‹`babel-polyfill`å’Œ`babel-runtime`çš„ä½¿ç”¨æ–¹æ³•

#### babel-polyfill 

1. å®‰è£…ï¼š`cnpm install @babel/polyfill -S`

2. åœ¨éœ€è¦çš„jsæ–‡ä»¶é¡¶éƒ¨å¼•å…¥`polyfill` å³å¯ï¼Œå¦‚ä¸‹ï¼š

```javascript
// src/index.js
import "@babel/polyfill";

const items = [1, 2, 3, 4, 5, 6]
for (let i of items) {
    console.log(i)
}

const mergeArr = Object.assign({}, items)
console.log(mergeArr)
```

å†æ¬¡æ‰“åŒ…ï¼Œå°±ä¼šå‘çŽ°ä¹‹å‰æ²¡æœ‰è¢«è½¬è¯‘æŽ‰çš„`Object.assign`ä¼šæ­£ç¡®åœ¨æµè§ˆå™¨ä¸­è¿è¡Œ

æŽ¥ä¸‹æ¥æ˜¯å¯¹`@babel/polyfill`å®žçŽ°æŒ‰éœ€åŠ è½½ï¼Œå¦‚ä¸‹

```javascript

module.exports = {
  // ...
  module: {
    rules: [
      {
        test: /\.js$/,
          // ä¸åŒ…å«
          exclude: /node_modules/,
          loader: 'babel-loader',
          // options é‡Œé¢çš„é…ç½®ä¹Ÿå¯ä»¥æ”¾åˆ°æ ¹ç›®å½•ä¸‹çš„.babelrc æ–‡ä»¶ä¸­
          options: {
            presets: [['@babel/preset-env', { useBuiltIns: 'usage' }]]
          }
        }
      }
    ] 
  }  
}
```

#### babel-runtime

TODODODODOODO

## ä»£ç åˆ†å‰²ï¼ˆä¼˜åŒ–ï¼‰

ä»£ç åˆ†å‰²å…è®¸æˆ‘ä»¬æŠŠä¸€ä¸ªå¤§æ–‡ä»¶æ‹†åˆ†æˆå¤šä¸ªå°æ–‡ä»¶ï¼Œç„¶åŽåŽ»æŒ‰éœ€/å¹¶è¡ŒåŠ è½½è¿™äº›æ–‡ä»¶ï¼Œå¦‚æžœä½¿ç”¨åˆç†ä¼šå¤§å¤§å‡å°‘é¡µé¢çš„åŠ è½½æ—¶é—´ï¼Œå¸¸ç”¨çš„ä»£ç åˆ†å‰²çš„æ–¹å¼æœ‰ä»¥ä¸‹ä¸‰ç§ï¼š

- å…¥å£èµ·ç‚¹ï¼šé€šè¿‡`entry`æ‰‹åŠ¨é…ç½®å¤šä¸ªå…¥å£æ–‡ä»¶
- é¿å…é‡å¤ï¼šé€šè¿‡`splitChunks`æ’ä»¶åˆ é™¤å¹¶æå–å…¬å…±ä»£ç ä½œä¸ºä¸€ä¸ªå•ç‹¬`chunks`
- åŠ¨æ€å¯¼å…¥ï¼šè°ƒç”¨`import()`æˆ–`require.ensure()`å¼‚æ­¥åŠ è½½æ¨¡å—

ä¸‹é¢æˆ‘ä»¬ä¼šåˆ†åˆ«å¯¹è¿™ä¸‰ç§æ‹†åŒ…æ–¹å¼è¿›è¡Œè¯•éªŒ

### ç¬¬ä¸€ç§ï¼šentry å¤šå…¥å£æ‹†åŒ…

ä½¿ç”¨`entry`å¤šå…¥å£è¿›è¡Œæ‹†åŒ…ï¼Œç±»ä¼¼è¿™æ ·ï¼š

```javascript
// ...
module.exports = {
  // entry: './src/index.js',
  entry: {
    file1: './src/file1.js',
    file2: './src/file2.js',
    // ...
    index: './src/index.js',
  },
  output: {
    // filename: 'index.js',
    filename: '[name].js',
    path: resolve(__dirname, 'dist'),
    libraryTarget: 'umd'
  },
  // ...
}

```

è¿™ç§æ–¹å¼æ˜¯ç”±å¼Šç«¯çš„ï¼š

`entry`ä¸­é…ç½®çš„æ‰€æœ‰æ–‡ä»¶ï¼Œåˆ†åˆ«å¼•å…¥äº†åŒä¸€ä¸ªæ¨¡å—æ—¶ä¼šå‡ºçŽ°é‡å¤æ‰“åŒ…è¯¥æ¨¡å—çš„æƒ…å†µï¼Œè€Œä¸ä¼šæŠŠè¿™ä¸ªå…±ç”¨çš„æ¨¡å—è¿›è¡ŒæŠ½ç¦»

å› æ­¤ï¼Œè¿™ç§åˆ†åŒ…æ–¹å¼å¹¶æ²¡æœ‰è¢«å¹¿æ³›ä½¿ç”¨ï¼ŒæŽ¥ä¸‹æ¥å¯ä»¥çœ‹çœ‹`splitChunks`æ˜¯å¦‚ä½•æ¥è§£å†³è¿™ç§é‡å¤æ‰“åŒ…çš„æƒ…å†µçš„

### splitChunks

ä»¥å‰ï¼Œæˆ‘ä»¬ä½¿ç”¨`CommonsChunkPlugin`åˆ†åŒ…æ¥é¿å…ä¾èµ–é‡å¤ï¼Œä½†åœ¨`4.0`ç‰ˆæœ¬å¼€å§‹å®ƒå·²è¢«ç§»é™¤ã€‚çŽ°åœ¨æˆ‘ä»¬é€šè¿‡`optimization.splitChunks`å’Œ`optimization.runtimeChunks`æ¥ä»£æ›¿å®ƒ

#### å¼€å§‹ä¹‹å‰

åœ¨å¼€å§‹ä¹‹å‰ï¼Œå…ˆäº†è§£ä¸‰ä¸ªåè¯ï¼š[](https://www.cnblogs.com/kwzm/p/10314438.html) 

- moduleï¼š`js`æ¨¡å—åŒ–`webpack`æ”¯æŒ`commonjsã€es6`ç­‰æ¨¡å—åŒ–è§„èŒƒï¼Œç®€å•æ¥è¯´å°±æ˜¯é€šè¿‡`import`ç­‰è¯­å¥å¼•å…¥çš„ä»£ç 

- chunkï¼š`chunk`æ˜¯`webpack`æ ¹æ®åŠŸèƒ½æ‹†åˆ†å‡ºæ¥çš„æƒ…å†µã€‚å®ƒåŒ…å«ä¸‰ç§ï¼š

  1. é¡¹ç›®å…¥å£`entry`
  2. é€šè¿‡`import()`åŠ¨æ€å¯¼å…¥çš„ä»£ç 
  3. é€šè¿‡`splitChunks`æ‹†åˆ†å‡ºæ¥çš„ä»£ç 

  `splitChunks`å°±æ˜¯åœ¨`chunk`çš„åŸºç¡€ä¸Šè¿›è¡Œæ‹†åˆ†çš„ã€‚`chunk`åŒ…å«`module`ï¼Œå¯èƒ½æ˜¯ä¸€å¯¹ä¸€æˆ–è€…ä¸€å¯¹å¤š

- bundleï¼š`bundle`æ˜¯`webpack`æ‰“åŒ…ä¹‹åŽç”Ÿæˆçš„æ–‡ä»¶ï¼Œä¸€èˆ¬æ˜¯å’Œ`chunk`ä¸€å¯¹ä¸€çš„å…³ç³»

#### ç›®å½•å‡†å¤‡

åœ¨äº†è§£`optimization.splitChunks`ä¹‹å‰ï¼Œå…ˆå‡†å¤‡ä»¥ä¸‹ç›®å½•ï¼š

```
â”œâ”€package.json
â”œâ”€src                 
â”‚  â””â”€file1.js         // åŒæ­¥å¼•å…¥ jquery, vue, file4
â”‚  â””â”€file2.js         // åŒæ­¥å¼•å…¥ lodash, file4, file5
â”‚  â””â”€file3.js         // åŒæ­¥å¼•å…¥ file5
â”‚  â””â”€file4.js         // å…±ç”¨æ¨¡å—ï¼Œè¢« file1 å’Œ file2 ä½¿ç”¨
â”‚  â””â”€file5.js         // å…±ç”¨æ¨¡å—ï¼Œè¢« file2 å’Œ file3 ä½¿ç”¨
â”‚  â””â”€index.js         // ä¸»å…¥å£ï¼šå¼‚æ­¥å¼•å…¥ file1, file2ï¼›åŒæ­¥å¼•å…¥ file3, vue
â”œâ”€webpack.config.js   // webpack é…ç½®æ–‡ä»¶
```
çŽ°æœ‰ 3 ä¸ª`chunk`ï¼Œåˆ†åˆ«æ˜¯é€šè¿‡`import`åŠ¨æ€å¯¼å…¥çš„`file1`ã€`file2`å’Œå…¥å£æ–‡ä»¶`index`ï¼Œå…¶ä¸­ï¼š

- file1 å’Œ file2 å…±ç”¨`file4`
- file2 å’Œ file3 å…±ç”¨`file5`

æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š

```javascript
// index.js
import './file3'
import vue from 'vue'
import(/* webpackChunkName: "file1" */'./file1')
import(/* webpackChunkName: "file2" */'./file2')

// file1.js
import $ from 'jquery'
import vue from 'vue'
import { name } from './file4'

// file2.js
import _ from 'lodash'
import { age } from './file4'
import { a } from './file5'

// file3.js
import { a } from './file5'

// file4.js
export const name = 'lily'
export const age = 18

// file5.js
export const a = 123
```

#### å¼€ç®±å³ç”¨

`optimization.splitChunks`æ˜¯å¼€ç®±å³ç”¨çš„ï¼Œå³å¯¹å®ƒ`ä¸åšä»»ä½•é…ç½®`çš„æ—¶å€™å®ƒå°±å¯ä»¥è¿›è¡Œæ‹†åŒ…å·¥ä½œã€‚å…¶é»˜è®¤æ‹†åˆ†ä»£ç è§„åˆ™å¦‚ä¸‹ï¼š


```javascript
module.exports = {
  optimization: {
    splitChunks: {
      chunks: "async",
      minSize: 30000,
      maxSize: 0,
      minChunks: 1,
      maxAsyncRequests: 5,
      maxInitialRequests: 3,
      automaticNameDelimiter: "~",
      name: true,
      cacheGroups: {
        vendors: {
          test: /[\\/]node_modules[\\/]/,
          priority: -10
        },
        default: {
          minChunks: 2,
          priority: -20,
          reuseExistingChunk: true
        }
      }
    }
  },
}
```
:::warning
ä¸è¦åœ¨æ²¡æœ‰å®žè·µæµ‹é‡çš„æƒ…å†µä¸‹ï¼Œå°è¯•æ‰‹åŠ¨ä¼˜åŒ–è¿™äº›å‚æ•°ã€‚é»˜è®¤æ¨¡å¼æ˜¯ç»è¿‡åƒæŒ‘ä¸‡é€‰çš„ï¼Œå¯ä»¥ç”¨äºŽæ»¡è¶³æœ€ä½³webæ€§èƒ½çš„ç­–ç•¥
:::

è¯´æ˜Žï¼š

ðŸƒ**splitChunks.chunks**

å®ƒå¯ä»¥è®¾ç½®ä¸‰ä¸ªå€¼ï¼Œåˆ†åˆ«æ˜¯`allã€asyncã€initial`ã€‚é»˜è®¤å€¼`async`ï¼Œå› ä¸º`webpack`æ›´å¸Œæœ›å°†ä»£ç ä¸­å¼‚æ­¥å¼•å…¥çš„éƒ¨åˆ†ä½œä¸ºç‹¬ç«‹æ¨¡å—è¿›è¡ŒæŠ½ç¦»ï¼Œåœ¨éœ€è¦çš„æ—¶å€™å†å¼•å…¥ï¼Œè¿™æ ·æ‡’åŠ è½½çš„å½¢å¼å¯ä»¥æå‡é¡µé¢æ€§èƒ½ã€‚ä¸‰ä¸ªå€¼çš„å…·ä½“è¡¨çŽ°å¦‚ä¸‹ï¼š

- asyncï¼šé»˜è®¤å€¼ï¼Œä»Žå¼‚æ­¥åŠ è½½ï¼ˆå¦‚`import()`åŠ¨æ€å¼•å…¥ï¼‰çš„`chunk`å¼€å§‹è¿›è¡Œæ‹†åˆ†ï¼Œéµå¾ªä»¥ä¸‹è§„å¾‹ï¼š

  ![splitChunks.chunks=initialçš„æµç¨‹å›¾](./images/js-split__chunks__asyncmap.png)

  ä¸‹é¢æ¥çœ‹çœ‹`chunks.async`çš„å…·ä½“è¡¨çŽ°ï¼š

  ![slitChunksé»˜è®¤åˆ†å‰²](./images/js-split__chunks__default.png)

  å¦‚å›¾ï¼šfile1ã€file2ã€index è¿™ä¸‰ä¸ª chunk è¢«æ‹†åˆ†çš„æƒ…å†µå¦‚ä¸‹ï¼š

  1. indexï¼šå•ç‹¬æŠ½ç¦»åˆ°äº†`index.js`ï¼ŒåŒ…æ‹¬åŒæ­¥å¼•å…¥çš„`vue`ã€`file3`åŠ`file3`ä¸­åŒæ­¥å¼•å…¥çš„`file5`
  2. file1ï¼šå•ç‹¬æŠ½ç¦»æˆ`file1.index.js`ï¼›å¼•ç”¨çš„ç¬¬ä¸‰æ–¹åŒ… jquery å’Œ vueï¼Œéƒ½è¢«æŠ½ç¦»åˆ°äº†`vendors~file1.index.js`
  3. file2ï¼šå•ç‹¬æŠ½ç¦»åˆ°äº†`file2.index.js`ï¼›å¼•ç”¨çš„ç¬¬ä¸‰æ–¹åŒ… lodashï¼ŒæŠ½ç¦»åˆ°äº†`vendors~file2.index.js`

---

- initialï¼šä»Žå…¥å£å¤„`chunk`å¼€å§‹è¿›è¡Œæ‹†åˆ†ï¼Œéµå¾ªä»¥ä¸‹è§„å¾‹ï¼š

  ![splitChunks.chunks=initialçš„æµç¨‹å›¾](./images/js-split__chunks__initialmap.png)

  ä¸‹é¢æ¥çœ‹çœ‹`chunks.initial`çš„å…·ä½“è¡¨çŽ°ï¼š

  ![splitChunks.chunks=initial](./images/js-split__chunks__initial.png)

  å¦‚å›¾ï¼šfile1ã€file2ã€index è¿™ä¸‰ä¸ª chunk è¢«æ‹†åˆ†çš„æƒ…å†µå¦‚ä¸‹ï¼š
  
  1. file1ï¼šè¢«æ‹†åˆ†æˆ`file1.index.js`ï¼Œä¸å¯¹`file1`å†…å®¹å†æ¬¡è¿›è¡Œæ‹†åˆ†
  2. file2ï¼šè¢«æ‹†åˆ†æˆ`file2.index.js`ï¼Œä¸å¯¹`file2`å†…å®¹å†æ¬¡è¿›è¡Œæ‹†åˆ†
  3. indexï¼šè¢«æ‹†åˆ†æˆ`index.js`ï¼Œå…¶ä¸­å¼•å…¥çš„ç¬¬ä¸‰æ–¹æ¨¡å—è¢«æ‹†åˆ†åˆ° `vendors~main.index.js`

---

- allï¼šä»¥ä¸Šä¸¤è€…éƒ½åŒ…æ‹¬ï¼ŒåŒæ­¥ã€å¼‚æ­¥æ¨¡å—å‡è¿›è¡Œæ‹†åˆ†

  ![splitChunks.chunks=all](./images/js-split__chunks__all.png)

---

ðŸƒ**minSize**ï¼š

å½“æ¨¡å—å¤§äºŽ`minSize`æ—¶ï¼Œè¿›è¡Œä»£ç åˆ†å‰²

---
ðŸƒ**minChunks**ï¼š

è¯¥æ¨¡å—æœ€å°‘è¢«ä½¿ç”¨äº†`minChunks`æ—¶æ‰è¢«åˆ†å‰²å‡ºæ¥

---
ðŸƒ**reuseExistingChunk**ï¼š

é‡å¤ä½¿ç”¨å·²ç»å­˜åœ¨çš„å—ï¼Œè‹¥æŸä¸ªæ¨¡å—åœ¨ä¹‹å‰å·²ç»è¢«æ‰“åŒ…è¿‡äº†ï¼ŒåŽé¢æ‰“åŒ…æ—¶å†é‡åˆ°è¿™ä¸ªæ¨¡å—å°±ç›´æŽ¥ä½¿ç”¨ä¹‹å‰æ‰“åŒ…çš„æ¨¡å—

---

ðŸƒ**name**ï¼š

æ˜¯å¦ä»¥`cacheGroups`ä¸­çš„`filename`ä½œä¸ºæ–‡ä»¶å

---

ðŸƒ**automaticNameDelimiter**ï¼š

æ‰“åŒ…çš„`chunk`åå­—è¿žæŽ¥ç¬¦ï¼Œå¦‚è®¾ä¸º`~`,ç”Ÿæˆçš„`chunk`æ–‡ä»¶åä¸º`chunk~name.js`

---

#### åˆ†åŒ…ç­–ç•¥

åœ¨çŸ¥é“ä»¥ä¸Šè¿™äº›è§„åˆ™åŽï¼Œæˆ‘ä»¬è®¾ç½®ä¸€ä¸ªè‡ªå·±çš„[åˆ†åŒ…ç­–ç•¥](https://www.jianshu.com/p/4f0600ea1c5f)ï¼Œå¦‚ï¼š

- åŸºç¡€ç±»åº“ï¼šreactï¼Œreact-reduxï¼Œreact-router
- UI åº“ï¼šantdï¼Œantd-icons
- å…¬å…±ç»„ä»¶åº“ï¼šè‡ªå®šä¹‰çš„å…¬å…±ç»„ä»¶
- ä½Žé¢‘ç»„ä»¶ï¼šechart
- ä¸šåŠ¡ä»£ç 

### åŠ¨æ€å¯¼å…¥ import()

åŠ¨æ€å¯¼å…¥`import()`ï¼Œæ˜¯ä¸€ä¸ªå¼‚æ­¥`chunk`ï¼Œ`webpack`ä¼šå¯¹å®ƒè¿›è¡Œå•ç‹¬æ‰“åŒ…ï¼Œ

`import()`æŽ¥æ”¶æ¨¡å—åä½œä¸ºå‚æ•°å¹¶è¿”å›ž`Promise`ï¼š`import(name) -> Promise`

```javascript
// ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š
import('./file1').then(r => {
  //...
})
```
#### é­”æ³•æ³¨é‡Š

åŠ¨æ€å¯¼å…¥`import()`ä¸å…è®¸æˆ‘ä»¬åœ¨å¯¼å…¥çš„æ—¶å€™ä½¿ç”¨é™¤äº†æ–‡ä»¶åä»¥å¤–çš„ä»»ä½•å‚æ•°ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`webpack`ä¸­çš„é­”æ³•æ³¨é‡Šæ¥å¸®æˆ‘ä»¬ä½¿ç”¨é™„åŠ å‚æ•°ï¼Œå¸¸ç”¨çš„å‡ ä¸ªå¦‚ä¸‹ï¼š

1. webpackChunkNameï¼šå®ƒå¯ä»¥æŒ‡å®šå½“å‰å¼‚æ­¥`chunk`è¢«æ‰“åŒ…åŽçš„æ–‡ä»¶åç§°

```javascript
import(/*webpackChunkName*/'./file1').then(r => {
  //...
})
```
2. webpackPrefetchï¼šé¢„å…ˆæ‹‰å–ï¼Œåœ¨ä½¿ç”¨ä¹‹å‰åŠ è½½ï¼›å®ƒä¼šåœ¨æµè§ˆå™¨ç©ºé—²çš„æ—¶å€™æ‰æ¥åŠ è½½è¯¥æ¨¡å—

```javascript
import(/*webpackPrefetch: true*/'./file1').then(r => {
  //...
})
```

3. webpackPreloadï¼š

æ‡’åŠ è½½ï¼Œåœ¨ä½¿ç”¨çš„æ—¶å€™æ‰åŽ»ä¸‹è½½ï¼ˆå› æ­¤ä¼šæœ‰ä¸€å®šçš„åŠ è½½æ—¶é—´é€ æˆç”¨æˆ·ç­‰å¾…ï¼‰ï¼›æ¯”å¦‚ç‚¹å‡»æŸä¸ªæŒ‰é’®åŠ è½½å¼¹çª—ï¼Œåœ¨ç‚¹å‡»æŒ‰é’®çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šé©¬ä¸ŠåŠ è½½è¿™éƒ¨åˆ†éœ€è¦çš„æ–‡ä»¶


```javascript
import(/*webpackPreload: true*/'./file1').then(r => {
  //...
})
```




