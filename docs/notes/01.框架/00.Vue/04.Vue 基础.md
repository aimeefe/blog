# Vue åŸºç¡€çŸ¥è¯†æ¢³ç†

## ç”Ÿå‘½å‘¨æœŸ

æ¯ä¸ª`Vue`å®ä¾‹åœ¨è¢«åˆ›å»ºæ—¶éƒ½è¦ç»è¿‡ä¸€ç³»åˆ—çš„åˆå§‹åŒ–è¿‡ç¨‹â€”â€”ä¾‹å¦‚ï¼Œéœ€è¦è®¾ç½®æ•°æ®ç›‘å¬ã€ç¼–è¯‘æ¨¡æ¿ã€å°†å®ä¾‹æŒ‚è½½åˆ°`DOM`å¹¶åœ¨æ•°æ®å˜åŒ–æ—¶æ›´æ–°`DOM`ç­‰ã€‚åŒæ—¶åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ä¹Ÿä¼šè¿è¡Œä¸€äº›å«åšç”Ÿå‘½å‘¨æœŸé’©å­çš„å‡½æ•°ï¼Œè¿™ç»™äº†ç”¨æˆ·åœ¨ä¸åŒé˜¶æ®µæ·»åŠ è‡ªå·±çš„ä»£ç çš„æœºä¼š

#### åˆå§‹åŒ–é˜¶æ®µï¼š

åˆå§‹åŒ–é˜¶æ®µä¼šå®Œæˆæ•°æ®çš„è§‚æµ‹ã€äº‹ä»¶çš„å¤„ç†ã€æ¨¡æ¿çš„æ¸²æŸ“ã€`dom`å…ƒç´ çš„æŒ‚è½½ç­‰äº‹æƒ…ï¼Œå®ƒåŒ…å«ï¼š

1. beforeCreateï¼šåœ¨å®ä¾‹åˆå§‹åŒ–ä¹‹åï¼Œæ•°æ®è§‚æµ‹ï¼ˆ`data observer`ï¼‰å’Œäº‹ä»¶é…ç½®ï¼ˆ`event/watcher`ï¼‰ä¹‹å‰è°ƒç”¨

2. createdï¼šå®ä¾‹å·²ç»åˆ›å»ºå®Œæˆä¹‹åè°ƒç”¨ï¼Œè¿™ä¸€é˜¶æ®µï¼Œå®ä¾‹å·²å®Œæˆï¼šæ•°æ®è§‚æµ‹ï¼ˆ`data observer`ï¼‰å±æ€§å’Œæ–¹æ³•çš„è¿ç®—ï¼Œäº‹ä»¶é…ç½®ï¼Œä½†æ˜¯æŒ‚è½½é˜¶æ®µè¿˜æœªå¼€å§‹ï¼Œå› æ­¤`$el`è¿˜ä¸å¯è§

3. beforeMountï¼šåœ¨æŒ‚è½½å…ƒç´ ä¹‹å‰å¼€å§‹è°ƒç”¨ï¼Œæ­¤æ—¶ç›¸å…³çš„`render`å‡½æ•°é¦–æ¬¡è¢«æ‰§è¡Œï¼Œé¡µé¢è¿˜æ²¡æœ‰å†…å®¹ï¼Œè¡¨è¾¾å¼`{{}}`çš„å€¼è¿˜æœªè¢«æ›¿æ¢

4. mountedï¼šç¼–è¯‘å¥½çš„`html`æŒ‚è½½åˆ°é¡µé¢å®Œæˆåè°ƒç”¨ï¼Œæ­¤æ—¶é¡µé¢å·²ç»è¢«æ¸²æŸ“å‡ºæ•°æ®

#### æ›´æ–°é˜¶æ®µ

1. beforeUpdateï¼šæ•°æ®æ›´æ–°æ—¶è°ƒç”¨ï¼Œå‘ç”Ÿåœ¨è™šæ‹Ÿ`DOM`é‡æ–°æ¸²æŸ“å’Œæ‰“è¡¥ä¸ä¹‹å‰ã€‚ ä½ å¯ä»¥åœ¨è¿™ä¸ªé’©å­ä¸­è¿›ä¸€æ­¥åœ°æ›´æ”¹çŠ¶æ€ï¼Œè¿™ä¸ä¼šè§¦å‘é™„åŠ çš„é‡æ¸²æŸ“è¿‡ç¨‹ã€‚

2. updateï¼šç”±äºæ•°æ®æ›´æ”¹å¯¼è‡´çš„è™šæ‹Ÿ`DOM`é‡æ–°æ¸²æŸ“å’Œæ‰“è¡¥ä¸ï¼Œåœ¨è¿™ä¹‹åä¼šè°ƒç”¨è¯¥é’©å­ã€‚

#### é”€æ¯é˜¶æ®µ

1. beforeDestroyï¼šé”€æ¯å‰è°ƒç”¨

2. destroyedï¼šé”€æ¯åè°ƒç”¨ï¼Œ`Vue`å®ä¾‹æŒ‡ç¤ºçš„æ‰€æœ‰ä¸œè¥¿éƒ½ä¼šè§£ç»‘å®šï¼Œæ‰€æœ‰çš„äº‹ä»¶ç›‘å¬å™¨ä¼šè¢«ç§»é™¤ï¼Œæ‰€æœ‰çš„å­å®ä¾‹ä¹Ÿä¼šè¢«é”€æ¯ã€‚ è¯¥é’©å­åœ¨æœåŠ¡å™¨ç«¯æ¸²æŸ“æœŸé—´ä¸è¢«è°ƒç”¨

ğŸƒ èµ„æ–™1ï¼š[æ ‡æ³¨å›¾+éƒ¨åˆ†ä¸¾ä¾‹èŠèŠVueç”Ÿå‘½å‘¨æœŸ][1]

ğŸƒ èµ„æ–™2ï¼š[å…³äºVueå®ä¾‹çš„ç”Ÿå‘½å‘¨æœŸcreatedå’Œmountedçš„åŒºåˆ«][2]


## æŒ‡ä»¤

### å†…ç½®æŒ‡ä»¤

- v-textï¼šæ›´æ–°å…ƒç´ çš„`textContent`

- v-htmlï¼šæ›´æ–°å…ƒç´ çš„`innerHTML`

- v-showï¼šæ ¹æ®è¡¨è¾¾å¼ä¹‹çœŸå‡å€¼ï¼Œåˆ‡æ¢å…ƒç´ çš„`display CSS`å±æ€§

- v-if ã€v-else-if ã€v-elseï¼šæ¡ä»¶åˆ¤æ–­

- v-forï¼šåŸºäºæºæ•°æ®å¤šæ¬¡æ¸²æŸ“å…ƒç´ æˆ–æ¨¡æ¿å—

- v-onï¼šï¼ˆè¯­æ³•ç³– `@`ï¼‰ç»‘å®šäº‹ä»¶ï¼Œ`vue`ä¸º`v-on`æä¾›äº†ä¿®é¥°ç¬¦ï¼Œå¦‚ä¸‹ï¼š

  - .stop - é˜»æ­¢äº‹ä»¶å†’æ³¡ï¼Œè°ƒç”¨ event.stopPropagation()
  - .prevent - é˜»æ­¢é»˜è®¤è¡Œä¸ºï¼Œè°ƒç”¨ event.preventDefault()
  - .capture - æ·»åŠ äº‹ä»¶ä¾¦å¬å™¨æ—¶ä½¿ç”¨ capture äº‹ä»¶æ•è·æ¨¡å¼
  - .self - å…ƒç´ æœ¬èº«è§¦å‘æ—¶æ‰è§¦å‘å›è°ƒ
  - .once - åªè°ƒç”¨ä¸€æ¬¡è¯¥äº‹ä»¶

- v-bindï¼ˆè¯­æ³•ç³– `:`ï¼‰å½“è¡¨è¾¾å¼çš„å€¼æ”¹å˜æ—¶ï¼Œå°†å…¶äº§ç”Ÿçš„è¿å¸¦å½±å“ï¼Œå“åº”å¼åœ°ä½œç”¨äº`DOM`

- v-modelï¼šè¡¨å•å…ƒç´ å®ç°åŒå‘æ•°æ®ç»‘å®šï¼Œå¯ä»¥ä½¿ç”¨çš„ä¿®é¥°ç¬¦å¦‚ä¸‹ï¼š

  - .trim - å»é™¤ä¸¤è¾¹ç©ºæ ¼
  - .number - è¾“å…¥å†…å®¹è½¬æ¢ä¸ºnumberç±»å‹
  - .lazy - å½“ç„¦ç‚¹ç¦»å¼€æ–‡æœ¬æ¡†æ—¶ï¼Œå±æ€§å€¼å‘ç”Ÿäº†å˜åŒ–å¹¶ä¸æ–‡æœ¬æ¡†å†…å®¹ä¿æŒä¸€è‡´

ğŸƒ èµ„æ–™1ï¼š[Vue.jså…¥é—¨æ•™ç¨‹-æŒ‡ä»¤][3]

### v-ifã€v-show ä½¿ç”¨åœºæ™¯

`v-if`çš„å€¼ä¸ºå‡æ—¶ï¼Œè¯¥å…ƒç´ ä¸ä¼šè¢«æ’å…¥`DOM`ï¼Œé€‚ç”¨äºéšè—å°šæœªåŠ è½½çš„å†…å®¹

`v-show`æ˜¯ä½¿ç”¨`css`æ ·å¼æ§åˆ¶å…ƒç´ çš„æ˜¾ç¤º/éšè—ï¼Œé€‚ç”¨äºé¢‘ç¹åˆ‡æ¢æŸäº›å†…å®¹

`v-if`æœ‰æ€§èƒ½å¼€é”€ï¼Œæ¯æ¬¡æ’å…¥æˆ–ç§»é™¤å…ƒç´ æ—¶å¿…é¡»è¦ç”Ÿæˆå…ƒç´ å†…éƒ¨çš„`DOM`æ ‘ï¼Œè¿™åœ¨æŸäº›æ—¶å€™æ˜¯éå¸¸å¤§çš„å·¥ä½œé‡;`v-show`é™¤äº†åœ¨åˆå§‹åˆ›å»ºå¼€é”€æ—¶ä¹‹å¤–æ²¡æœ‰é¢å¤–çš„å¼€é”€

`v-if`å¯¹äºä¸€ä¸ªè¿˜ä¸å­˜åœ¨çš„å¯¹è±¡çš„å±æ€§ä½¿ç”¨æ—¶ä¸ä¼šæŠ¥é”™ï¼Œå› ä¸º`vue`ç›´åˆ°`v-if`è¯­å¥ä¸ºçœŸæ—¶æ‰ä¼šå°è¯•ç”Ÿæˆè¯¥å…ƒç´ å…¨éƒ¨å†…å®¹;è€Œ`v-show`ä¼šæŠ¥é”™ï¼Œå› ä¸ºè¯¥å…ƒç´ å†…å®¹ä¸€ç›´å­˜åœ¨çš„ï¼Œåªæ˜¯è¢«éšè—äº†

å¦‚æœå…ƒç´ åŒ…å«å›¾ç‰‡ï¼Œé‚£ä¹ˆä»…ä½¿ç”¨`css`éšè—çˆ¶èŠ‚ç‚¹å°±å¯ä»¥ä½¿æµè§ˆå™¨åœ¨å›¾ç‰‡æ˜¾ç¤ºä¹‹å‰å°±åŠ è½½å®ƒï¼Œè¿™æ„å‘³ç€ä¸€æ—¦`v-show`ä¸ºçœŸï¼Œå›¾ç‰‡å°±å¯ä»¥æ˜¾ç¤ºå‡ºæ¥ã€‚å¦‚æœæ˜¯`v-if`æŒ‡ä»¤ï¼Œå›¾ç‰‡ä¼šç›´åˆ°è¦æ˜¾ç¤ºæ—¶æ‰å¼€å§‹åŠ è½½ã€‚


### è‡ªå®šä¹‰æŒ‡ä»¤

é€šè¿‡`directive`å°±å¯ä»¥åœ¨`Vue`ä¸Šæ³¨å†Œä¸€ä¸ªè‡ªå®šä¹‰æŒ‡ä»¤ï¼ˆå…¨å±€æ³¨å†Œã€å±€éƒ¨æ³¨å†Œï¼‰

ğŸŒ° ä¸¾ä¾‹æ³¨å†Œä¸€ä¸ªè‡ªå®šä¹‰æŒ‡ä»¤ï¼Œå®ç°é¡µé¢åŠ è½½è‡ªåŠ¨èšç„¦åˆ°å…ƒç´ 

```javascript
// 1. æ³¨å†Œä¸€ä¸ªå…¨å±€è‡ªå®šä¹‰æŒ‡ä»¤ `v-focus`
Vue.directive('focus', {
  // å½“è¢«ç»‘å®šçš„å…ƒç´ æ’å…¥åˆ° DOM ä¸­æ—¶â€¦â€¦
  inserted: function (el) {
    // èšç„¦å…ƒç´ 
    el.focus()
  }
})

// 2. æ³¨å†Œä¸€ä¸ªå±€éƒ¨è‡ªå®šä¹‰æŒ‡ä»¤ `v-focus`
directives: {
  focus: {
    // æŒ‡ä»¤çš„å®šä¹‰
    inserted: function (el) {
      el.focus()
    }
  }
}

// ä½¿ç”¨
<input v-focus>
```
ğŸƒ èµ„æ–™1ï¼š[ã€è¯‘ã€‘vue è‡ªå®šä¹‰æŒ‡ä»¤çš„é­…åŠ›][4]

ğŸƒ èµ„æ–™2ï¼š[vue è‡ªå®šä¹‰æŒ‡ä»¤][5]

## filter è¿‡æ»¤å™¨

è¿‡æ»¤å™¨ï¼ˆå…¨å±€è¿‡æ»¤å™¨ï¼Œå±€éƒ¨è¿‡æ»¤å™¨ï¼‰å¯ä»¥é€šè¿‡ç®¡é“ç¬¦å·`|`å®ç°æ–‡æœ¬æ•°æ®çš„æ ¼å¼åŒ–ï¼Œå¯ä»¥ç”¨åœ¨è¡¨è¾¾å¼ `{{}}`å’Œ`bind`ä¸­

```javascript
// å…¨å±€è¿‡æ»¤å™¨
Vue.filter('toTime', function(value) {
  //value è¡¨ç¤ºè¦è¿‡æ»¤çš„å†…å®¹
})

// æ‰¹é‡æ³¨å†Œå…¨å±€è¿‡æ»¤å™¨
import * as filters from "config/filters"

Object.keys(filters).forEach(key => {
  Vue.filter(key, filters[key]);
});

// å±€éƒ¨è¿‡æ»¤å™¨
var app = new Vue({
  el: '#app',
  data: {},
  filters: {
    toTime: function(value){
      //value è¡¨ç¤ºè¦è¿‡æ»¤çš„å†…å®¹
    }
  }
})

// ä½¿ç”¨
<div :data-time="date | toTime">{{ date | toTime }}</div>
```
è¿‡æ»¤å™¨å¯ä»¥ä¸²è”ã€æ¥æ”¶å‚æ•°ï¼Œæ¯”å¦‚ï¼š

```javascript
{{ message | filterA | filterB }}
{{ message | filterA('p1', 'p2') }}
```

## computed è®¡ç®—å±æ€§

ä½¿ç”¨æ–¹æ³•ï¼š

```javascript
<p>æˆ‘çš„åå­—ï¼š{{ fullname }}</p>

var vm = new Vue({
  el: '#app',
  data: {
    firstname: 'jack',
    lastname: 'rose'
  },
  computed: {
    fullname() {
      return this.firstname + '.' + this.lastname
    }
  }
})
```

æ³¨æ„ï¼š`computed`ä¸­çš„å±æ€§ä¸èƒ½ä¸`data`ä¸­çš„å±æ€§åŒåï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚

## watch ç›‘æµ‹æ•°æ®

ç›‘æµ‹å±æ€§`watch`å¯ä»¥é€šè¿‡ç›‘æµ‹æ•°æ®æ¥å“åº”æ•°æ®çš„å˜åŒ–ï¼Œå¯åœ¨æ•°æ®å˜åŒ–æ—¶éœ€è¦æ‰§è¡Œå¼‚æ­¥æˆ–å¼€é”€è¾ƒå¤§çš„æ“ä½œæ—¶ä½¿ç”¨ã€‚

å®ƒæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé”®æ˜¯éœ€è¦è§‚å¯Ÿçš„è¡¨è¾¾å¼ï¼Œå€¼æ˜¯å¯¹åº”å›è°ƒå‡½æ•°ï¼Œå›è°ƒå‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°åˆ†åˆ«æ˜¯æ–°å€¼å’Œæ—§å€¼ã€‚

âš ï¸ æ³¨æ„ï¼š`watcher`å›è°ƒå‡½æ•°ä¸å¯ç”¨ç®­å¤´å‡½æ•°ï¼Œç®­å¤´å‡½æ•°ç»‘å®šäº†çˆ¶çº§ä½œç”¨åŸŸçš„ä¸Šä¸‹æ–‡ï¼Œä¼šæ”¹å˜`this`æŒ‡å‘ã€‚

```javascript
new Vue({
  data: { 
    a: 1,
    b: { 
      age: 10 
    } 
  },
  watch: {
    a: function(newVal, oldVal) {
      //å¦‚æœaå‘ç”Ÿæ”¹å˜ï¼Œè¿™ä¸ªå‡½æ•°å°±ä¼šè¿è¡Œ
    },

    /**
     * ç›‘å¬å¯¹è±¡å˜åŒ–
     * deep - æ·±åº¦ç›‘æµ‹ï¼Œå¯¹è±¡å†…éƒ¨å±æ€§æˆ–æ–¹æ³•å‘ç”Ÿæ”¹å˜ï¼Œä½¿ç”¨å®ƒæ‰èƒ½ç›‘æµ‹åˆ°è¯¥å¯¹è±¡çš„æ”¹å˜
     * immediate - ç«‹å³æ‰§è¡Œï¼Œåˆå§‹åŒ–çš„æ—¶å€™ watch æ˜¯ä¸ä¼šæ‰§è¡Œçš„ï¼Œå¦‚æœæƒ³åœ¨åˆå§‹åŒ–çš„æ—¶å€™å°±æ‰§è¡Œï¼Œåˆ™éœ€å¼€å¯è¿™ä¸ªå±æ€§
     */
    b: {
      handler: function (val, oldVal) {
        //TODO ...
      },
      deep: true,
      immediate: true
    },

    /**
     * ç›‘å¬å¯¹è±¡å…·ä½“æŸä¸ªå±æ€§çš„å˜åŒ–
     */
    'b.age': function (val, oldVal) {
      //TODO ...
    },
  }
})
```

#### Q: `watch`åœ¨ä»»ä½•æ—¶å€™éƒ½å¯ä»¥ç›‘æµ‹çš„åˆ°æ•°æ®å˜åŠ¨å—ï¼Ÿ

å¹¶ä¸æ˜¯æ‰€æœ‰çš„æ”¹å˜éƒ½ä¼šè§¦å‘`watch`ç›‘å¬ï¼Œå¦‚ï¼š

1. æ•°ç»„ï¼šé€šè¿‡å…¶ä¸‹æ ‡å¯¹æŸä¸ªå±æ€§åšå¤„ç†çš„æ—¶å€™ï¼ˆå¢ã€åˆ ã€æ”¹ï¼‰

- ä½¿ç”¨åŸç”Ÿçš„æ–¹æ³•å¯¹æ•°ç»„çš„æŸä¸ªä¸‹æ ‡é‡æ–°èµ‹å€¼ï¼Œå¦‚ï¼š`arr[0] = {name: 'lily'}`
- ä¿®æ”¹æ•°ç»„æŸä¸ªä¸‹æ ‡çš„æŸä¸ªå±æ€§çš„å€¼ï¼Œå¦‚`arr[0].name = 'lily'`
- ä½¿ç”¨åŸç”Ÿ`delete`åˆ é™¤æ•°ç»„æŸä¸ªä¸‹æ ‡çš„æŸä¸ªå±æ€§çš„å€¼ï¼Œå¦‚ï¼š`delete arr[0].name`
- å¯¹æ•°ç»„æŸä¸ªä¸‹æ ‡æ–°å¢ä¸€ä¸ªå±æ€§ï¼ˆä¸ä½¿ç”¨ $setï¼‰ï¼Œå¦‚ï¼š`arr[0].name = 'lily'`

2. å¯¹è±¡ï¼š

- å¯¹åˆå§‹åŒ–æ—¶`data`ä¸­ä¸å­˜åœ¨çš„æ•°æ®åšå¤„ç†ï¼ˆå¢ã€åˆ ã€æ”¹ï¼‰
- ä½¿ç”¨åŸç”Ÿæ–¹æ³•`delete`åˆ é™¤å¯¹è±¡ä¸­æŸä¸ªå­—æ®µ

è§£å†³åŠæ³•å¦‚ä¸‹ï¼š

- å¯¹äºæ–°å¢æˆ–åˆ é™¤ç­‰æ“ä½œä½¿ç”¨`vue`æä¾›çš„æ–¹æ³•ï¼Œå¦‚`$set()ã€$delete()`

- å…‹éš†ï¼Œå¦‚`Object.assign()`ã€`JSON.parse(JSON.stringify(obj))`ã€`{...obj}`ã€`[...arr]`ç­‰


ğŸƒ èµ„æ–™1ï¼š[Vue watché€‰é¡¹][6]

ğŸƒ èµ„æ–™2ï¼š[Vueçš„computedå’Œwatchçš„ç»†èŠ‚å…¨é¢åˆ†æ][7]

ğŸƒ èµ„æ–™3ï¼š[Vueä¸­$watchçš„ç›‘å¬å˜åŒ–][8] & [vueä¸­æ­£ç¡®çš„ä½¿ç”¨watchè¿›è¡Œç›‘å¬][9]

## computedã€methodsã€{{}} çš„åº”ç”¨åœºæ™¯

- {{}}ï¼šå¸¸ç”¨äºç®€å•çš„è¿ç®—ï¼Œå½“è¿‡é•¿æˆ–é€»è¾‘å¤æ‚æ—¶ä¼šå˜å¾—éš¾ä»¥ç»´æŠ¤ã€‚

- computedï¼šå¸¸ç”¨äºå¤æ‚çš„é€»è¾‘è¿ç®—ï¼ŒåŸºäºä¾èµ–ç¼“å­˜ã€‚å½“è®¡ç®—å±æ€§æ‰€ä¾èµ–çš„æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæ‰ä¼šé‡æ–°å–å€¼ï¼Œå½“éå†å¤§æ•°ç»„æˆ–åšå¤§é‡è®¡ç®—æ—¶ä½¿ç”¨è®¡ç®—å±æ€§æ¯”è¾ƒå¥½

- methodsï¼šé‡Œçš„æ–¹æ³•åªè¦é‡æ–°æ¸²æŸ“å°±ä¼šè¢«è°ƒç”¨ï¼Œå‡½æ•°ä¹Ÿä¼šè¢«æ‰§è¡Œã€‚

## ç»„ä»¶æ³¨å†Œ

### å…¨å±€æ³¨å†Œ

æ–¹æ³•ï¼šä½¿ç”¨`Vue.component(tagName, options)`å¯ä»¥æ³¨å†Œä¸€ä¸ªå…¨å±€çš„ç»„ä»¶ï¼Œå…¨å±€ç»„ä»¶åœ¨æ‰€æœ‰çš„vueå®ä¾‹ä¸­éƒ½å¯ä»¥ä½¿ç”¨

```javascript
let myButton = Vue.extend({ 
  template: `<button>ç‚¹å‡»æˆ‘</button>`,
  // ç»„ä»¶ä¸­çš„ data å¿…é¡»æ˜¯å‡½æ•° å¹¶ä¸”å‡½æ•°çš„è¿”å›å€¼å¿…é¡»æ˜¯å¯¹è±¡
  data() {
    return {}
  }
}) 

Vue.component('my-button', myButton) 
```
è¯­æ³•ç³–ï¼š

```javascript
Vue.component('my-button', { 
  template: `<button>ç‚¹å‡»æˆ‘</button>`
})
```

ä½¿ç”¨ï¼š
```javascript
<div id="app"> 
  <my-button /> 
</div>
```

### å±€éƒ¨æ³¨å†Œ

æ–¹æ³•ï¼šä½¿ç”¨`Vue`å®ä¾‹ / ç»„ä»¶å®ä¾‹é€‰é¡¹ä¸­`components`æ³¨å†Œï¼Œå±€éƒ¨æ³¨å†Œçš„ç»„ä»¶åªå¯ä»¥åº”ç”¨åœ¨å½“å‰å®ä¾‹ä¸­ã€‚

```javascript
let myButton = Vue.extend({ 
  template: `<button>ç‚¹å‡»æˆ‘</button>` 
})

let app = new Vue({ 
  el: '#app',
  components: {
    'my-button':myButton
  }
}) 
```
è¯­æ³•ç³–ï¼š

```javascript
let app = new Vue({ 
  el: '#app',
  components: {
    'my-button': {
      template: `<button>ç‚¹å‡»æˆ‘</button>` 
    }
  }
})
```

ä½¿ç”¨ï¼š

```javascript
<div id="app"> 
    <my-button /> 
</div>
```
ğŸƒ èµ„æ–™ï¼š[Vue.jså…¥é—¨æ•™ç¨‹-ç»„ä»¶æ³¨å†Œ][10]

## ç»„ä»¶é€šä¿¡

### propsï¼šçˆ¶ -> å­

1. å­ç»„ä»¶å¯ä»¥é€šè¿‡`props`å£°æ˜ä»çˆ¶ç»„ä»¶æ¥æ”¶è¿‡æ¥çš„æ•°æ®ï¼Œ`props`å€¼åˆ†ä¸¤ç§ï¼Œä¸€ç§æ˜¯å­—ç¬¦ä¸²æ•°ç»„ï¼Œä¸€ç§æ˜¯å¯¹è±¡ (éœ€è¦å¯¹å€¼éªŒè¯å¯ä»¥ç”¨å¯¹è±¡)ã€‚

2. ç”±äº`html`ç‰¹æ€§ä¸åŒºåˆ†å¤§å°å†™ï¼Œå½“ä½¿ç”¨`dom`æ¨¡æ¿æ—¶ï¼Œé©¼å³°å‘½åçš„`props`åç§°è¦è½¬ä¸ºçŸ­æ¨ªçº¿åˆ†éš”å‘½åï¼ˆå­—ç¬¦ä¸²æ¨¡æ¿é™¤å¤–ï¼‰

3. å¦‚æœä¼ é€’çš„æ•°æ®ä¸æ˜¯ç›´æ¥å†™æ­»çš„ï¼Œè€Œæ˜¯æ¥è‡ªçˆ¶çº§çš„åŠ¨æ€æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨æŒ‡ä»¤`v-bind`æ¥åŠ¨æ€ç»‘å®š `props`çš„å€¼ï¼Œå½“çˆ¶ç»„ä»¶çš„æ•°æ®å˜åŒ–æ—¶ï¼Œä¹Ÿä¼šä¼ é€’ç»™å­ç»„ä»¶ ï¼Œåä¹‹ä¸è¡Œ

4.  ä¸šåŠ¡ä¸­ç»å¸¸ä¼šé‡åˆ°ä¸¤ç§éœ€è¦æ”¹å˜`props`çš„æƒ…å†µï¼š
    - ä¼ é€’åˆå§‹å€¼è¿›æ¥ï¼Œå­ç»„ä»¶å°†å®ƒä½œä¸ºåˆå§‹å€¼ä¿å­˜åˆ°dataä¸­ï¼Œåœ¨è‡ªå·±ä½œç”¨åŸŸä¸‹å¯ä»¥éšæ„ä½¿ç”¨å’Œä¿®æ”¹
    - propä½œä¸ºéœ€è¦è¢«è½¬å˜çš„åŸå§‹å€¼ä¼ å…¥ï¼Œè¿™ç§æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨è®¡ç®—å±æ€§

    ä½†æ˜¯ï¼Œä»¥ä¸Šä¸¤ç§æƒ…å†µï¼Œé’ˆå¯¹äºå¼•å…¥ç±»å‹çš„æ•°æ®ï¼Œåœ¨å­ç»„ä»¶ä¸­ä¿®æ”¹å€¼æ˜¯ä¼šå½±å“åˆ°çˆ¶ç»„ä»¶çš„å€¼çš„ï¼Œéœ€è¦æ³¨æ„ï¼


ä¾‹å­ï¼šåŸºäº`vue-cli`

```JavaScript
// çˆ¶ç»„ä»¶ - ä¼ é€’ msg1 çš„å€¼åˆ°å­ç»„ä»¶

<template>
  <div class="parent-box">
    æˆ‘æ˜¯çˆ¶ç»„ä»¶
    <child :msg1="msg1"></child>
  </div>
</template>

<script>
import child from "./components/child";  
export default {
  name: "app",
  components: { child },
  data() {
    return {
      msg1: "æˆ‘æ˜¯msg1 - çˆ¶ç»„ä»¶ä¼ ç»™å­ç»„ä»¶çš„ç¬¬1ä¸ªå€¼", 
    };
  }
};
</script>
```

```JavaScript
//å­ç»„ä»¶child - æ¥æ”¶æ¥è‡ªçˆ¶ç»„ä»¶çš„ msg1 çš„å€¼

<template>
  <div class="child-box">
    æˆ‘æ˜¯å­ç»„ä»¶
    {{msg1}}
  </div>
</template>

<script>
export default {
  name: "child",
  props: ["msg1"], //props æ¥æ”¶æ¥è‡ªçˆ¶ç»„ä»¶ä¼ é€’è¿‡æ¥çš„å€¼
};
</script>
```


### $emitï¼šå­ -> çˆ¶

å½“å­ç»„ä»¶éœ€è¦åƒçˆ¶ç»„ä»¶ä¼ é€’æ•°æ®æ—¶ï¼Œå°±è¦ç”¨åˆ°è‡ªå®šä¹‰äº‹ä»¶ã€‚

ç±»ä¼¼è§‚å¯Ÿè€…æ¨¡å¼ï¼Œå­ç»„ä»¶ç”¨`$emit`æ¥è§¦å‘äº‹ä»¶ï¼Œçˆ¶ç»„ä»¶ç”¨`v-on`ï¼ˆè¯­æ³•ç³–`@`ï¼‰æ¥ç›‘å¬å­ç»„ä»¶è§¦å‘çš„è‡ªå®šä¹‰äº‹ä»¶ã€‚

ç”¨æ³•ï¼š 
`step1`ï¼šçˆ¶ç»„ä»¶ - å®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼Œå¹¶é€šè¿‡`v-on`ï¼ˆè¯­æ³•ç³–`@`ï¼‰ç»‘å®šç»™å­ç»„ä»¶ï¼Œå¦‚ï¼š

```JavaScript
<child :msg1="msg1" @changeMsg1="changeMsg1"></child>
```
`step2`ï¼šå­ç»„ä»¶ - é€šè¿‡ `$emit` è§¦å‘å·²ç»‘å®šçš„æ–¹æ³•ï¼Œå¦‚ï¼š

```JavaScript
//å‚æ•°1 eventName - æ–¹æ³•å
//å‚æ•°2 [...arg] - è¦è¿”ç»™è¢«è§¦å‘æ–¹æ³•çš„å‚æ•°
this.$emit("changeMsg1", 'ä¼ ç»™çˆ¶ç»„ä»¶çš„å‚æ•°'); 
```

ä¾‹å­ï¼š

```JavaScript

//çˆ¶ç»„ä»¶ - ä¼ é€’ç»™å­ç»„ä»¶ä¸€ä¸ªå‡½æ•° changeMsg1 

<template>
  <div class="parent-box">æˆ‘æ˜¯çˆ¶ç»„ä»¶
    <child :msg1="msg1" @changeMsg1="changeMsg1"></child>
  </div>
</template>

<script>
import child from "./components/child";
export default {
  name: "app",
  components: { child },
  data() {
    return {
      msg1: "æˆ‘æ˜¯msg1 - çˆ¶ç»„ä»¶ä¼ ç»™å­ç»„ä»¶çš„ç¬¬1ä¸ªå€¼",
    };
  },
  methods: {
    //å‚æ•° data æ˜¯å­ç»„ä»¶ä¼ é€’è¿‡æ¥çš„å‚æ•°
    changeMsg1(data) {
      this.msg1 = data;
    }
  }
};
</script>
```

```JavaScript

//å­ç»„ä»¶child - ç»™ button ç»‘å®š handleClick æ–¹æ³•ï¼Œåœ¨ handleClick ä¸­é€šè¿‡ $emit å»è§¦å‘changeMsg1æ–¹æ³•ï¼Œå¹¶ä¼ å‚è¿‡å»

<template>
  <div class="child-box">
    {{msg1}}
    <button @click="handleClick">btn</button>
  </div>
</template>

<script>
export default {
  name: "child",
  props: ["msg1"],
  methods: {
    handleClick() {
      this.$emit("changeMsg1", 'ä¼ ç»™çˆ¶ç»„ä»¶çš„å‚æ•°'); 
    }
  }
};
</script>

```

### $parent & $childrenã€$refs

`this.$parent` å¯ä»¥ç›´æ¥è®¿é—®è¯¥ç»„ä»¶çˆ¶å®ä¾‹æˆ–ç»„ä»¶ï¼ˆå­ -> çˆ¶ï¼‰ï¼Œçˆ¶ç»„ä»¶ä¹Ÿå¯ä»¥é€šè¿‡`this.$children`è®¿é—®æ‰€æœ‰å­ç»„ä»¶ï¼ˆæ•°ç»„ï¼‰ï¼ˆçˆ¶ -> å­ï¼‰ï¼Œè€Œä¸”å¯ä»¥é€’å½’å‘ä¸Šæˆ–å‘ä¸‹æ— çº¿è®¿é—®ï¼Œç›´åˆ°æ ¹å®ä¾‹æˆ–æœ€å†…å±‚ç»„ä»¶ã€‚

ä¸šåŠ¡ä¸­å­ç»„ä»¶åº”è¯¥åº”è¯¥å°½å¯èƒ½é¿å…ä¾èµ–çˆ¶ç»„ä»¶æ•°æ®ï¼Œæ›´ä¸è¯¥ä¸»åŠ¨ä¿®æ”¹çˆ¶ç»„ä»¶æ•°æ®ï¼Œè¿™æ ·ä¼šä½¿çˆ¶å­ç»„ä»¶è€¦åˆä¸¥é‡ï¼Œåªçœ‹çˆ¶ç»„ä»¶å¾ˆéš¾ç†è§£çˆ¶ç»„ä»¶çŠ¶æ€ï¼Œå› ä¸ºçˆ¶ç»„ä»¶çš„å€¼å¯èƒ½è¢«éšæ„ä¿®æ”¹äº†ã€‚

è¿™ç§æ–¹å¼é€‚ç”¨äºä¸€ä¸ªé¡µé¢å•çº¯çš„æ‹†åˆ†æˆå¤šä¸ªç»„ä»¶ç»„åˆåœ¨ä¸€èµ·çš„æƒ…å†µï¼Œè¢«æ‹†åˆ†çš„ç»„ä»¶åªæœ‰ä¸€ä¸ªå…¬ç”¨ä¸”ç¡®å®šäº†çš„çˆ¶ç»„ä»¶ã€‚

ä¾‹å­ï¼š

```JavaScript
//çˆ¶ç»„ä»¶ - é€šè¿‡ $children æ”¹å˜å­ç»„ä»¶ tip å€¼
<template>
  <div class="parent-box">
    æˆ‘æ˜¯çˆ¶ç»„ä»¶
    <child :msg="msg"></child>
    <button @click="handleClick">çˆ¶btn</button>
  </div>
</template>

<script>
import child from "./components/child";
export default {
  name: "app",
  components: { child },
  data() {
    return {
      msg: "æˆ‘æ˜¯çˆ¶ç»„ä»¶ msg çš„å€¼"
    };
  },
  methods: {
    handleClick() {
      this.$children.map(i => {
        i.tip = "æˆ‘æ˜¯çˆ¶ç»„ä»¶ï¼Œæˆ‘ç”¨ $children æ”¹å˜äº†å­ç»„ä»¶ child ä¸­ tipçš„å€¼";
      });
    }
  }
};
</script>
```

```JavaScript
//å­ç»„ä»¶ - é€šè¿‡ $parent æ”¹å˜çˆ¶ç»„ä»¶ msg å€¼
<template>
  <div class="child-box">
    æˆ‘æ˜¯å­ç»„ä»¶
    {{tip}}
    {{msg}}
    <button @click="handleClick">å­btn</button>
  </div>
</template>

<script>
export default {
  name: "child",
  props: ["msg"],
  data() {
    return {
      tip: "æˆ‘æ˜¯å­ç»„ä»¶çš„æ•°æ®ï¼Œè°èƒ½æ”¹å˜æˆ‘ï¼Ÿ"
    };
  },
  methods: {
    handleClick() {
      this.$parent.msg = "æˆ‘æ˜¯å­ç»„ä»¶ï¼Œæˆ‘ç”¨ $parent æ”¹å˜äº†çˆ¶ç»„ä»¶ä¸­ msg çš„å€¼";
    }
  }
};
</script>
```

å½“å­ç»„ä»¶å¾ˆå¤šæ—¶ï¼Œå¾ˆéš¾é€šè¿‡`$children`éå†å‡ºæ¥éœ€è¦çš„ç»„ä»¶å®ä¾‹ï¼Œå¯ä»¥ç”¨`ref`æ¥ä¸ºå­ç»„ä»¶æŒ‡å®šä¸€ä¸ªç´¢å¼•åç§°ï¼Œç„¶åç”¨`this.$refs[name]`æ¥æŸ¥æ‰¾

ä¾‹å­ï¼š

```JavaScript

//çˆ¶ç»„ä»¶ - ç”¨ ref ç»™å­ç»„ä»¶ child è®¾ç½®ç´¢å¼•åï¼Œé€šè¿‡ refs å»æŸ¥æ‰¾å­ç»„ä»¶
<template>
  <div class="parent-box">
    æˆ‘æ˜¯çˆ¶ç»„ä»¶
    <child ref="component1" :msg="msg"></child>
    <button @click="handleClick">çˆ¶btn</button>
  </div>
</template>

<script>
import child from "./components/child";
export default {
  name: "app",
  components: { child },
  data() {
    return {
      msg: "æˆ‘æ˜¯çˆ¶ç»„ä»¶ msg çš„å€¼"
    };
  },
  methods: {
    handleClick() {
      this.$refs.component1.tip = 'æˆ‘æ˜¯çˆ¶ç»„ä»¶ï¼Œæˆ‘è¦é€šè¿‡ $refs æ¥æŸ¥æ‰¾å­ç»„ä»¶ child å¹¶ä¿®æ”¹ å®ƒçš„ tip å€¼'
    }
  }
};
</script>
```

### EventBusï¼šéçˆ¶å­ç»„ä»¶é€šè®¯

å¦‚æœæ¶‰åŠåˆ°çˆ·å­™ä¹‹é—´ã€å…„å¼Ÿä¹‹é—´æˆ–æ›´æ·±å±‚æ¬¡ç»„ä»¶ä¹‹é—´éœ€è¦é€šä¿¡ï¼Œå¯ä»¥å£°æ˜ä¸€ä¸ª`vue`å®ä¾‹ï¼ŒæŠŠå…¬å…±æ–¹æ³•å’Œå±æ€§æ”¾åœ¨è¿™ä¸ªå®ä¾‹ä¸Šé¢ï¼Œè®©è¿™ä¸ªå®ä¾‹å……å½“ä¸€æ¡é€šè®¯æ¡¥æ¢ã€‚

èŒƒå›´ï¼šé€‚ç”¨äºç®€å•åœºæ™¯ï¼Œå¤æ‚åœºæ™¯è¯·ç”¨ `vuex`

æ­¥éª¤ï¼šåŸºäº`vue-cli`

`step1ï¼š`åˆ›å»ºä¸€ä¸ª`vue`å®ä¾‹ï¼ŒæŒ‚è½½åˆ°å…¨å±€ï¼Œæ¯”å¦‚ï¼š

```JavaScript
//main.js æ–‡ä»¶

Vue.prototype.$bus = new Vue();

//æˆ–

window.$bus = new Vue();
```

`step2ï¼š`ç”¨`$on`å’Œ`$emit`å®Œæˆé€šä¿¡

```JavaScript
// $on ç›‘å¬äº‹ä»¶ï¼Œå¤„ç†å›è°ƒ
bus.$on('eventName', val => {
  //TODO...
})

// $emit è§¦å‘äº‹ä»¶ï¼Œè¿”å›å‚æ•°
bus.$emit('eventName', val)
```

ä¾‹å­ï¼šè®©ä¸¤ä¸ªåŒçº§ç»„ä»¶é€šè®¯

```JavaScript
//main.js - å£°æ˜ä¸€ä¸ªå…¨å±€å˜é‡æ¥ä¿å­˜ vue å®ä¾‹

import Vue from 'vue'
import App from './App.vue'

Vue.config.productionTip = false

Vue.prototype.$bus = new Vue();   // $bus

new Vue({
  render: h => h(App),
}).$mount('#app')

```

```JavaScript
// æ ¹ç»„ä»¶ - åŒ…å«ä¸¤ä¸ªå­ç»„ä»¶
<template>
  <div class="parent-box">
    æˆ‘æ˜¯çˆ¶ç»„ä»¶
    <child></child>
    <child2></child2>
  </div>
</template>

<script>
import child from "./components/child";
import child2 from "./components/child2";

export default {
  name: "app",
  components: { child, child2 }
};
</script>
```

```JavaScript
//child å­ç»„ä»¶ - $on ç›‘å¬äº‹ä»¶ï¼Œå¦‚æœæœ‰æ–°å‚æ•°è¿›æ¥ç«‹å³æ›¿æ¢ childMsg å€¼
<template>
  <div class="child-box">
    æˆ‘æ˜¯å­ç»„ä»¶ child
    {{childMsg}}
  </div>
</template>

<script>
export default {
  name: "child",
  data() {
    return {
      childMsg: "æˆ‘æ˜¯childçš„æ•°æ®"
    };
  },
  created() {

    //$on ç›‘å¬
    this.$bus.$on('changeMsg', data => {
      this.childMsg = data;
    })
  },

};
</script>
```

```JavaScript
//child2 - $emit è§¦å‘äº‹ä»¶ï¼Œå¹¶ä¼ é€’å‚æ•°åˆ° changeMsg æ–¹æ³•ä¸­
<template>
  <div class="child-box">
    æˆ‘æ˜¯å­ç»„ä»¶ child2
    <button @click="handleClick">child2 btn</button>
  </div>
</template>

<script>
export default {
  name: "child2",
  methods: {
    handleClick() {

      //$emit è§¦å‘
      this.$bus.$emit('changeMsg', 'æˆ‘æ˜¯ child2 ï¼Œæˆ‘æ›´æ”¹äº† child çš„ childMsg å€¼')
    }
  }
};
</script>
```

### v-modelï¼šåŒå‘æ•°æ®ç»‘å®š - å•ä¸ªå±æ€§

`v-model`å¯ä»¥åœ¨ [è¡¨å•æ§ä»¶][11] æˆ–è€…ç»„ä»¶ä¸Šåˆ›å»ºåŒå‘ç»‘å®šã€‚

è¡¨å•æ§ä»¶ä¸Šçš„åŒå‘ç»‘å®šï¼Œå¦‚ï¼š

```JavaScript
<input v-model="msg">

//ç›¸å½“äºï¼š

<input :value="msg" @input="msg = $event.target.value">
```
å¦‚ä¸Šï¼Œå¯ä»¥çœ‹å‡ºè¯­æ³•ç³–`v-model`çš„å®ç°è¿‡ç¨‹ï¼šå°†`input`æ ‡ç­¾ç”¨`v-bind`ç»‘å®š`value`å±æ€§ï¼Œ`v-on`ç»‘å®š`input`äº‹ä»¶ã€‚å½“è¾“å…¥æ¡†çš„æ–‡æœ¬å‘ç”Ÿæ”¹å˜æ—¶ï¼Œè‡ªåŠ¨å°†å±æ€§`value`çš„å€¼æ›¿æ¢æˆç›®æ ‡è¾“å…¥å€¼ã€‚

é‚£ä¹ˆï¼Œæ¢åˆ°ç»„ä»¶ä¸­è¯¥æ€ä¹ˆå®ç°å‘¢ï¼Ÿ

çˆ¶ç»„ä»¶ï¼š
é€šè¿‡`v-model`ç»‘å®šå˜é‡

```JavaScript
<child v-model="msg"></child>

//ç›¸å½“äº

<child :value="msg" @input="msg = arguments[0]"></child>
```

å­ç»„ä»¶ï¼š
- æ¥æ”¶ä¸€ä¸ª`value`å±æ€§
- åœ¨æœ‰æ–°çš„`value`æ—¶è§¦å‘`input`äº‹ä»¶


ä¸¾ä¸ªæ —å­ï¼š

```JavaScript
// çˆ¶ç»„ä»¶ - ç”¨ v-model ç»‘å®š msg
<template>
  <div class="parent-box">
    æˆ‘æ˜¯çˆ¶ç»„ä»¶
    è¿™æ˜¯æˆ‘çš„ msg å€¼ï¼š{{msg}}
    <child v-model="msg"></child>
  </div>
</template>

<script>
import child from "./components/child";

export default {
  name: "app",
  components: { child },
  data() {
    return {
      msg: "æˆ‘æ˜¯çˆ¶ç»„ä»¶çš„ msg"
    };
  }
};
</script>
```

```JavaScript
//å­ç»„ä»¶ - é€šè¿‡ props æ¥æ”¶ valueï¼Œç”¨ $emit è§¦å‘ input äº‹ä»¶
<template>
  <div class="child-box">
    æˆ‘æ˜¯å­ç»„ä»¶ child
    <button @click="handleClick">child's btn</button>
  </div>
</template>

<script>
export default {
  name: "child",
  props: ["value"],
  methods: {
    handleClick() {
      this.$emit("input", "æˆ‘æ˜¯ childï¼Œè¿™æ˜¯æˆ‘ä¼ ç»™çˆ¶ç»„ä»¶çš„æ–°å€¼");
    }
  }
};
</script>
```

ä¸Šä¾‹ä¸­ï¼Œå¦‚æœå±æ€§`value`è¢«å ç”¨äº†ï¼Œæˆ–è€…`input`äº‹ä»¶å†²çªäº†ï¼Œå°±ä¼šå¼•èµ·æŠ¥é”™ï¼Œæ‰€ä»¥æœ€å¥½[ç”¨ model å±æ€§æ¥å®šåˆ¶ v-model][12]

å®šåˆ¶æ–¹æ³•ï¼š`model { prop?: string, event?: string }`

ä¸Šä¾‹ä¸­ï¼Œ`child`ç»„ä»¶é‡å†™ä¸ºï¼š

```JavaScript
//child - é€šè¿‡ model å®šåˆ¶ v-model
<template>
  <div class="child-box">
    æˆ‘æ˜¯å­ç»„ä»¶ child
    <button @click="handleClick">child's btn</button>
  </div>
</template>

<script>
export default {
  name: "child",
  model: {
    prop: 'msg',  //ä»£æ›¿ value
    event: 'changeMsg' //ä»£æ›¿inputæ–¹æ³•
  },
  props: ["msg"],
  methods: {
    handleClick() {
      this.$emit("changeMsg", "æˆ‘æ˜¯ childï¼Œè¿™æ˜¯æˆ‘ä¼ ç»™çˆ¶ç»„ä»¶çš„æ–°å€¼");
    }
  }
};
</script>
```

### .syncï¼šåŒå‘æ•°æ®ç»‘å®š - å¤šä¸ªå±æ€§

2.3ç‰ˆæœ¬ä¸­é‡æ–°å¼•å…¥çš„[.sync ä¿®é¥°ç¬¦][13]ä½œä¸ºè¯­æ³•ç³–å­˜åœ¨ï¼Œå®ƒä¼šè¢«æ‰©å±•ä¸ºè‡ªåŠ¨æ›´æ–°çˆ¶ç»„ä»¶å±æ€§çš„`v-on`ç›‘å¬å™¨ï¼Œå¦‚ä¸‹ï¼š

```JavaScript
<child :msg.sync="msg"></child>

//ç›¸å½“äº

<child :msg="msg" @update:msg="val => msg = val"></child>
```
å½“å­ç»„ä»¶éœ€è¦æ›´æ–°`msg`æ—¶ï¼Œè§¦å‘updateæ–¹æ³•ï¼Œå°†æ—§å€¼æ›¿æ¢æˆæ–°å€¼ï¼Œå¦‚ä¸‹ï¼š

```JavaScript
this.$emit('update:name', newVal)

```

ä¸€æ¬¡æ€§æƒ³ä¼ é€’å¤šä¸ªå±æ€§æ—¶ï¼Œå¯ä»¥ç»“åˆ`v-bind`ä¸€èµ·ä½¿ç”¨ï¼Œå¦‚ä¸‹ï¼š

```JavaScript
//çˆ¶ç»„ä»¶ - ä¼ é€’ä¸€ä¸ªå¯¹è±¡åˆ°å­ç»„ä»¶ï¼Œä¼šåˆ†åˆ«ä¸ºå¯¹è±¡çš„æ¯ä¸ªå±æ€§åˆ†é…ä¸€ä¸ª v-on ç›‘å¬å™¨
<template>
  <div class="parent-box">
    æˆ‘æ˜¯çˆ¶ç»„ä»¶
    {{info.msg1}}
    {{info.msg2}}
    <child v-bind.sync="info"></child>
  </div>
</template>

<script>
import child from "./components/child";

export default {
  name: "app",
  components: { child },
  data() {
    return {
      info: {
        msg1: 1111,
        msg2: 2222
      }
    };
  }
};
</script>
```

```JavaScript
//å­ç»„ä»¶ - $emit è§¦å‘äº‹ä»¶

<template>
  <div class="child-box">
    æˆ‘æ˜¯å­ç»„ä»¶ child
    <button @click="handleClick">child's btn</button>
  </div>
</template>

<script>
export default {
  name: "child",
  methods: {
    handleClick() {
      this.$emit("update:msg1", "33333");
      this.$emit("update:msg2", "44444");
    }
  }
};
</script>
```


### $attrs & $listeners
1. åœ¨å¤šçº§ç»„ä»¶é€šä¿¡ä¸­ï¼Œ[$attrs & $listeners][14] åˆ†åˆ«è´Ÿè´£æ”¶é›†çˆ¶ç»„ä»¶ä¸­ä¼ é€’è¿‡æ¥çš„å±æ€§å’Œäº‹ä»¶ï¼Œå…¶ä¸­`$attr`ä¸­æ”¶é›†çš„å±æ€§ä¸åŒ…æ‹¬ç»„ä»¶ä¸­å·²é€šè¿‡`props`æ¥å—çš„å±æ€§ï¼Œ`$listeners`ä¸­æ”¶é›†çš„äº‹ä»¶ä¸åŒ…æ‹¬æœ‰`.native`ä¿®é¥°ç¬¦çš„äº‹ä»¶ã€‚å±æ€§é€šè¿‡`v-bind="$attrs"`ä¸€çº§çº§å‘ä¸‹ä¼ é€’ï¼Œ äº‹ä»¶é€šè¿‡`v-on="$listeners"`ä¸€çº§çº§å‘ä¸‹ä¼ é€’ã€‚

2. `$attrs`ä¸­åŒ…å«çš„å±æ€§ï¼Œé»˜è®¤æƒ…å†µä¸‹å°†ä¼šä½œä¸ºæ™®é€šçš„`HTML`å±æ€§åº”ç”¨åœ¨å­ç»„ä»¶çš„æ ¹å…ƒç´ ä¸Šï¼Œå¯ä»¥é€šè¿‡åœ¨å½“å‰ç»„ä»¶ä¸­è®¾ç½®`inheritAttrs: false` å»æ‰ï¼ˆ`style`, `class`é™¤å¤–ï¼‰ï¼Œå»æ‰é»˜è®¤è¡Œä¸ºä¸å½±å“æ•°æ®çš„ä½¿ç”¨ã€‚

ä¾‹å¦‚ï¼š

æœªè®¾ç½® `inheritAttrs: false`æ—¶ï¼š

```
<div class="grandson-box" msg3="333" msg4="444"></div>
```

è®¾ç½®äº† `inheritAttrs: false`æ—¶ï¼š

```
<div class="grandson-box"></div>
```

<div class="grandson-box"></div>

3. é€‚ç”¨èŒƒå›´ï¼šç®€å•çš„å¤šçº§ç»„ä»¶é€šä¿¡

ä¾‹å­ï¼š

```JavaScript
// ä¸€çº§ç»„ä»¶ - é€šè¿‡ v-bind, v-on ä¼ é€’å±æ€§å’Œäº‹ä»¶åˆ°ä¸‹çº§ç»„ä»¶

<template>
  <div class="parent-box">
    æˆ‘æ˜¯çˆ·çˆ·
    <son v-bind="msg" @event1="event1" @event2.native="event2" @event3="event3" @event4="event4"></son>
  </div>
</template>

<script>
import son from "./components/son";

export default {
  name: "app",
  components: { son },
  data() {
    return {
      msg: {
        msg1: 111,
        msg2: 222,
        msg3: 333,
        msg4: 444
      }
    };
  },
  methods: {
    event1() {
      console.log(1);
    },
    event2() {
      console.log(2);
    },
    event3(data) {
      console.log(3, data); //3, æˆ‘æ˜¯å­™å­ç»„ä»¶grandsonä¼ é€’åˆ°çˆ·çˆ·é‚£å»çš„å‚æ•°
    },
    event4() {
      console.log(4);
    }
  }
};
</script>
```

```JavaScript
// äºŒçº§ç»„ä»¶ - é€šè¿‡ v-bind="$attrs" v-on="$listeners" ä¼ é€’å±æ€§å’Œäº‹ä»¶åˆ°ä¸‹ä¸€çº§ç»„ä»¶ä¸­
<template>
  <div class="son-box">
    æˆ‘æ˜¯å„¿å­ {{$attrs}}
    <grandson v-bind="$attrs" v-on="$listeners"/>
  </div>
</template>

<script>
import grandson from "./grandson";
export default {
  name: "son",
  inheritAttrs: false, //ç»„ä»¶æ ¹éƒ¨å±è”½æ‰ $attrs çš„å±æ€§ï¼Œä½†æ˜¯å€¼ä»ç„¶å­˜åœ¨åªæ˜¯ä¸å±•ç¤ºåœ¨ html ä¸Šäº†
  components: { grandson },
  props: ["msg1", "msg2"], //é€šè¿‡ props æ¥æ”¶çš„å±æ€§ ä¼šè¢«è¿‡æ»¤ï¼Œä¸å­˜åœ¨ $attrs ä¸­
  created() {
    console.log("----- son -------");
    //å¦‚æœä¸Šçº§ç»„ä»¶ä¼ é€’è¿‡æ¥çš„äº‹ä»¶å«æœ‰ .native ä¿®é¥°ç¬¦ï¼Œåˆ™è¯¥äº‹ä»¶è¢«è¿‡æ»¤ï¼Œ ä¸å­˜åœ¨ $listeners ä¸­
    console.log(this.$listeners); //{event1: Æ’, event3: Æ’, event4: Æ’}
  }
};
</script>

```

```JavaScript
// ä¸‰çº§ç»„ä»¶
<template>
  <div class="grandson-box">
    æˆ‘æ˜¯å­™å­
    {{$attrs.msg3}}
  </div>
</template>

<script>
export default {
  name: "grandson",
  created() {
    console.log("------ grandson ------");
    console.log(this.$listeners); //{event1: Æ’, event3: Æ’, event4: Æ’}
    this.$listeners.event3("æˆ‘æ˜¯å­™å­ç»„ä»¶grandsonä¼ é€’åˆ°çˆ·çˆ·é‚£å»çš„å‚æ•°");
  }
};
</script>

```

ğŸƒ èµ„æ–™ä¸€ï¼š[vueç»„ä»¶çš„é‚£ç‚¹äº‹][15]

ğŸƒ èµ„æ–™äºŒï¼š[vueç»„ä»¶é€šä¿¡å…¨æ­ç§˜(å…±7ç« )][16]

ğŸƒ èµ„æ–™ä¸‰ï¼š[Vue.js çˆ¶å­ç»„ä»¶é€šä¿¡çš„åç§æ–¹å¼][17]



[1]: https://juejin.im/post/5bd6962e51882558bd3f0696
[2]: https://segmentfault.com/a/1190000008570622
[3]: https://segmentfault.com/a/1190000014388896
[4]: https://juejin.im/post/59ffbcc151882554b836ee21
[5]: https://segmentfault.com/a/1190000014370906
[6]: https://juejin.im/post/5a571fcb6fb9a01c9a26a9ba
[7]: https://segmentfault.com/a/1190000012948175
[8]: https://segmentfault.com/a/1190000010245810
[9]: https://segmentfault.com/a/1190000010280989?_ea=8920131
[10]: https://segmentfault.com/a/1190000015157007
[11]: https://cn.vuejs.org/v2/api/#v-model
[12]: https://cn.vuejs.org/v2/api/#model
[13]: https://cn.vuejs.org/v2/guide/components-custom-events.html#sync-%E4%BF%AE%E9%A5%B0%E7%AC%A6
[14]: https://cn.vuejs.org/v2/api/#vm-attrs
[15]: https://juejin.im/post/5c1304645188257c3045eb12#heading-6
[16]: https://juejin.im/post/5bd97e7c6fb9a022852a71cf#heading-102
[17]: https://juejin.im/post/5bd18c72e51d455e3f6e4334?utm_source=gold_browser_extension
